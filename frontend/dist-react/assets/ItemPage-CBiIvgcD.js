import{r as j,j as e,c as f,L,a as U,u as D,y as u,e as P,b as T,f as G,g as A}from"./index-ByPv5Bvs.js";import{C as v,a as N,c as w,d as y,b as F}from"./card-hnSC__fQ.js";import{b,B as o,L as B,M as K,u as k,S as I}from"./button-CGpUeQNU.js";import{S as x,D as Q,a as R,b as z,j as H,k as W}from"./dropdown-menu-DA2naSt3.js";import{H as _}from"./Profilepage-DbTKIAbK.js";import{N as $}from"./Navbar-CXTN0aWk.js";import{d as J,e as V,u as X}from"./apiItem-D7vawNq-.js";import{C as M}from"./Close-CnCZ8KQD.js";import{M as q}from"./Modal-CsqSQ6m2.js";import{I as g}from"./input-XNtBvshv.js";import{L as m}from"./label-CNNC-uAT.js";import{P as S}from"./Docspage-C322__Hx.js";import"./UserAvatar-WpywStcO.js";function O(a){const t=new Date(a),s=new Date;return Math.ceil((t.getTime()-s.getTime())/(1e3*60*60*24))}function d({field:a,fieldName:t,suffix:s,small:l}){return e.jsxs(B,{className:f("flex justify-between items-center",l?"text-sm":"text-md"),children:[e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[t," :"," "]}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[a||e.jsx(K,{children:"NA"}),s]})]})}function Y({className:a,item:t,small:s,barebone:l=!1,viewMorePath:h}){const[c,p]=j.useState(!1);return e.jsxs("div",{className:f("relative duration-100 aspect-square transform-3d shadow-2xl",c?"rotate-y-180":"rotate-y-0",s?"w-xs":"w-md",a),children:[e.jsxs(v,{className:f("h-full w-full flex flex-col justify-center items-center p-4 gap-2 absolute top-0 left-0 rotate-y-180",c?"z-20":"z-0"),children:[e.jsx(N,{className:"w-full text-center",children:e.jsx(b,{className:"jet-brains",children:"Scan Me"})}),e.jsx(w,{className:f("flex flex-col justify-between",s?"h-60 w-60":"h-90 w-90"),children:e.jsx("img",{src:`https://encode.ravishdev.org/api/create/text_url?text_url=http://localhost:5173/item/${t?.SKU}&fg=%2368a872&bg=%230e2033`,alt:t?.name.substring(0,10),className:"w-full rounded-2xl"})}),e.jsx(y,{className:"w-full px-0",children:e.jsx(o,{onClick:()=>p(!1),className:"w-full",children:"Show Information"})})]}),e.jsx("div",{className:"h-full w-full bg-ls-bg-300 dark:bg-ls-bg-dark-800 rounded-2xl"}),e.jsxs(v,{className:f("h-full w-full flex flex-col justify-between p-4 absolute top-0 left-0 gap-2",c?"z-0":"z-20"),children:[e.jsxs(N,{className:"w-full h-min ",children:[e.jsx(b,{className:"text-center jet-brains",children:t?.SKU?.substring(25)}),t.expiresOn&&O(t.expiresOn)<=15&&e.jsxs("div",{className:f("bg-ls-sec-400 dark:bg-ls-sec-900 rounded-lg w-full flex items-center justify-center gap-1 jet-brains",s?"p-1 text-sm":"p-1 text-md"),children:[e.jsx(_,{})," item exipres in"," ",O(t.expiresOn)," days"]})]}),e.jsxs(w,{className:"w-full h-full gap-2 flex flex-col overflow-y-auto p-4 rounded-2xl",children:[e.jsx(d,{small:s,field:t.name,fieldName:"Name"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.inventoryCategory,fieldName:"Category"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.origin,fieldName:"Origin"}),t?.expiresOn&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:new Date(t.expiresOn).toLocaleDateString(),fieldName:"Expires On"})]}),!l&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.costPrice,fieldName:"Cost Price",suffix:" /-"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.sellingPrice,fieldName:"Selling Price",suffix:" /-"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.quantity,fieldName:"Quantity",suffix:" units"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:new Date(t.importedOn).toLocaleDateString(),fieldName:"Imported On"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.colour,fieldName:"Colour"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.weight,fieldName:"Weight"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.importance,fieldName:"Importance"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.reorderLevel,fieldName:"Reorder Level"}),!s&&e.jsx(x,{}),e.jsx(d,{small:s,field:t.batchNumber,fieldName:"Batch Number"})]})]}),e.jsx(y,{className:"w-full flex flex-col justify-between px-0 gap-2",children:e.jsxs("div",{className:"w-full grid grid-cols-2 gap-2",children:[e.jsx(o,{onClick:()=>p(!0),className:"w-full",children:"Show Qrcode"}),e.jsx(L,{to:h||"/authenticate",className:"w-full",children:e.jsx(o,{className:"w-full",children:"More About Item"})})]})})]})]})}function Z(a){const{data:t,isPending:s}=U({queryKey:["item"],queryFn:()=>J(a)});return{item:t,isPending:s}}function ee(){const a=D(),{mutate:t,isPending:s}=k({mutationFn:V,onSuccess:()=>{a.invalidateQueries({predicate:l=>l.queryKey[0]?.toString()==="items"}),u.success("Item deleted successfully",{className:"toast"})},onError:l=>{u.error(l.message,{className:"toast"})}});return{deleteItemFn:t,isPending:s}}function se({open:a,setOpen:t,itemData:s}){const[l,h]=j.useState(""),c=P(),{deleteItemFn:p,isPending:r}=ee();return e.jsx(q,{openModal:a,children:e.jsxs(v,{children:[e.jsxs(N,{className:"flex justify-between items-center",children:[e.jsx(F,{children:"Remove Item"}),e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:e.jsx(M,{})})]}),e.jsxs(w,{className:"grid gap-4",children:[e.jsxs(I,{children:["Item's Name : ",s.name]}),e.jsxs(I,{children:["Item's SKU : ",s.SKU?.substring(25)]}),e.jsxs(m,{title:"remove item",htmlFor:"removeitem",className:"grid",children:[e.jsxs("span",{children:['Enter "',e.jsxs("span",{className:"text-red-500",children:["remove ",s.name]}),'" in the input below to remove item']}),e.jsx(g,{placeholder:"Enter Text",type:"text",value:l,name:"name",required:!0,className:"text-sm md:text-md",onChange:i=>h(i.target.value)})]})]}),e.jsxs(y,{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:()=>{p(s._id),h(""),t(!1),c(-1)},disabled:r||l.trim()!==`remove ${s.name}`,variant:"destructive",children:"Remove Item"})]})]})})}function te(){const a=D(),{mutate:t,isPending:s}=k({mutationFn:X,onSuccess:()=>{a.invalidateQueries({predicate:l=>l.queryKey[0]?.toString().startsWith("item")||!1}),u.success("Item updated successfully",{className:"toast"})},onError:l=>{u.error(l.message,{className:"toast"})}});return{updateItemFn:t,isPending:s}}function re(a,t){if(!t)return t;switch(a){case"KG":return t*1e3;case"MG":return t/1e3;default:return t}}function ne({open:a,setOpen:t,item:s}){const{isPending:l,updateItemFn:h}=te(),[c,p]=j.useState("G"),[r,i]=j.useState({name:s.name,costPrice:s.costPrice,sellingPrice:s.sellingPrice,quantify:s.quantity,inventoryCategory:s.inventoryCategory,importance:s.importance||"C",importedOn:new Date(s.importedOn).toISOString(),expiresOn:new Date(s.expiresOn).toISOString(),weight:s.weight,colour:s.colour,reorderLevel:s.reorderLevel,origin:s.origin}),C=()=>{if(r.name.trim()==="")return u.warning("Item should have a name",{className:"toast"});if(r.costPrice<=0)return u.warning("Cost price can't be 0",{className:"toast"});if(r.sellingPrice<=0)return u.warning("Selling price can't be 0",{className:"toast"});if(r.quantify<=0)return u.warning("Quantity can't be 0",{className:"toast"});if(r.inventoryCategory.trim()==="")return u.warning("Category of item is required",{className:"toast"});if(!["A","B","C"].includes(r.importance.trim()))return u.warning("Item importance is invalid",{className:"toast"});if(new Date(r.importedOn)>new Date)return u.warning("Imported data can't be in future",{className:"toast"});if(r.weight&&r.weight<=0)return u.warning("Item can't be weightless",{className:"toast"});const n=JSON.parse(JSON.stringify(r));n.weight=re(c,r.weight),n.name=n.name.trim(),n.inventoryCategory=n.inventoryCategory.trim(),n.colour=n.colour?.trim(),n.origin=n.origin?.trim(),h({itemId:s._id,newItem:n}),t(!1)};return e.jsx(q,{openModal:a,children:e.jsxs(v,{className:"min-w-lg max-w-screen",children:[e.jsxs(N,{className:"flex justify-between items-center",children:[e.jsx(F,{children:"Update item"}),e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:e.jsx(M,{})})]}),e.jsxs(w,{className:"grid gap-2 max-h-96 overflow-auto",children:[e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(m,{htmlFor:"name",className:"grid",children:[e.jsx("span",{children:"Name"}),e.jsx(g,{id:"name",name:"name",type:"text",value:r.name,onChange:n=>i({...r,name:n.target.value}),placeholder:"Enter item's name"})]}),e.jsxs(m,{htmlFor:"inventory-category",className:"grid",children:[e.jsx("span",{children:"Inventory Category"}),e.jsx(g,{id:"inventory-category",name:"inventoryCategory",type:"text",value:r.inventoryCategory,onChange:n=>i({...r,inventoryCategory:n.target.value}),placeholder:"Enter item's inventory category"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(m,{htmlFor:"costprice",className:"grid",children:[e.jsx("span",{children:"Cost Price"}),e.jsx(g,{id:"costprice",name:"costPrice",type:"number",value:r.costPrice,min:0,onChange:n=>i({...r,costPrice:Number(n.target.value)}),placeholder:"Enter item cost price",required:!0})]}),e.jsxs(m,{htmlFor:"sellingprice",className:"grid",children:[e.jsx("span",{children:"Selling Price"}),e.jsx(g,{id:"sellingprice",name:"sellingPrice",type:"number",value:r.sellingPrice,onChange:n=>i({...r,sellingPrice:Number(n.target.value)}),placeholder:"Enter item selling price",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(m,{htmlFor:"quantity",className:"grid",children:[e.jsx("span",{children:"Quantity"}),e.jsx(g,{id:"quantity",name:"quantity",type:"number",value:r.quantify,onChange:n=>i({...r,quantify:Number(n.target.value)}),placeholder:"Enter item quantity",required:!0})]}),e.jsxs("div",{className:"flex gap-2 items-end w-full",children:[e.jsxs(m,{htmlFor:"weight",className:"grid w-full",children:[e.jsx("span",{children:"Weight"}),e.jsx(g,{id:"weight",name:"weight",type:"number",min:1,value:r.weight,onChange:n=>i({...r,weight:Number(n.target.value)}),placeholder:"Enter item's weight"})]}),e.jsxs(Q,{children:[e.jsx(R,{asChild:!0,children:e.jsx(o,{variant:"outline",children:c})}),e.jsx(z,{children:e.jsx(H,{defaultValue:c,onValueChange:n=>p(n),children:["KG","G","MG"].map((n,E)=>e.jsx(W,{value:n,children:n},E))})})]})]})]}),e.jsxs(m,{htmlFor:"importance",className:"grid",children:[e.jsx("span",{children:"Importance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(o,{onClick:()=>i({...r,importance:"A"}),variant:r.importance==="A"?"secondary":"outline",className:"rounded-e-none",children:"A"}),e.jsx(o,{onClick:()=>i({...r,importance:"B"}),variant:r.importance==="B"?"secondary":"outline",className:"rounded-s-none rounded-e-none",children:"B"}),e.jsx(o,{onClick:()=>i({...r,importance:"C"}),variant:r.importance==="C"?"secondary":"outline",className:"rounded-s-none",children:"C"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(m,{htmlFor:"importedon",className:"grid",children:[e.jsx("span",{children:"Imported On"}),e.jsx(g,{id:"importedon",name:"importedOn",type:"date",value:new Date(r.importedOn).toISOString().split("T")[0],max:r.expiresOn?new Date(r.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:n=>{i({...r,importedOn:new Date(n.target.valueAsDate||r.importedOn).toISOString()})},placeholder:"Enter item's imported date",className:"w-full",required:!0})]}),e.jsxs(m,{htmlFor:"expireson",className:"grid",children:[e.jsx("span",{children:"Expires On"}),e.jsx(g,{id:"expireson",name:"expiresOn",type:"date",value:r.expiresOn?new Date(r.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],min:new Date(r.importedOn).toISOString().split("T")[0],onChange:n=>{i({...r,expiresOn:n.target.valueAsDate?new Date(n.target.valueAsDate).toISOString():void 0})},placeholder:"Enter item's expiry date",className:"w-full"})]})]}),e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(m,{htmlFor:"colour",className:"grid",children:[e.jsx("span",{children:"Colour"}),e.jsx(g,{id:"colour",name:"colour",type:"text",value:r.colour,onChange:n=>i({...r,colour:n.target.value}),placeholder:"Enter item's colour"})]}),e.jsxs(m,{htmlFor:"origin",className:"grid",children:[e.jsx("span",{children:"Origin Place"}),e.jsx(g,{id:"origin",name:"origin",type:"text",value:r.origin,onChange:n=>i({...r,origin:n.target.value}),placeholder:"Enter item's origin place"})]})]}),e.jsx("div",{className:"grid gap-2 grid-cols-2",children:e.jsxs(m,{htmlFor:"reorderlevel",className:"grid",children:[e.jsx("span",{children:"Re-Order Level"}),e.jsx(g,{id:"reorderlevel",name:"reorderLevel",type:"number",min:0,value:r.reorderLevel,onChange:n=>i({...r,reorderLevel:Number(n.target.value)}),placeholder:"Enter item's re-order level"})]})})]}),e.jsxs(y,{className:"flex gap-2",children:[e.jsx(o,{type:"button",onClick:()=>t(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:C,disabled:l,children:"Update Item"})]})]})})}function je(){const{SKU:a}=T();a||u.error("Item not found",{className:"toast"});const{item:t,isPending:s}=Z(a||""),{user:l,isPending:h}=G(),c=l?.user,p=P(),[r,i]=j.useState(!1),[C,n]=j.useState(!1);return s||h?e.jsx(A,{}):e.jsxs("div",{className:"flex flex-col gap-3 items-center bg-ls-bg-300 dark:bg-ls-bg-dark-800 min-h-screen relative",children:[e.jsx($,{hide:{userButton:!0}}),t?e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>p(-1),children:[e.jsx(S,{})," Go Back"]}),e.jsxs("div",{className:"grid gap-2 p-2 outline-1 rounded-2xl items-center",children:[e.jsx(Y,{item:t,barebone:!c,viewMorePath:c?"/dashboard":"/authenticate"}),c&&e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx(o,{variant:"secondary",className:"flex-1",onClick:()=>n(!0),children:"Edit Item Data"}),e.jsx(o,{variant:"destructive",className:"flex-1",onClick:()=>i(!0),children:"Delete Data"}),e.jsx(se,{open:r,setOpen:i,itemData:t}),e.jsx(ne,{open:C,setOpen:n,item:t})]})]}),e.jsx("div",{className:"w-20"})]}):e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>p(-1),children:[e.jsx(S,{})," Go Back"]}),e.jsx("div",{className:"grid place-items-center gap-2 p-2 min-w-md outline-1 rounded-2xl items-center",children:"Not Item Found"}),e.jsx("div",{className:"w-20"})]})]})}export{je as default};
