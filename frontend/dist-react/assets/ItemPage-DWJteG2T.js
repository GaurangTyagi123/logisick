import{r as j,j as e,c as f,L as G,a as k,u as F,y as m,e as E,b as K,f as A,g as B}from"./index-D9kiWyLS.js";import{C as y,a as w,c as C,d as b,b as q}from"./card-CvgKRfF2.js";import{b as S,B as o,L as Q,M as R,u as M,S as O}from"./button-D3ywnnhV.js";import{S as u,D as z,a as H,b as W,j as _,k as $}from"./dropdown-menu-CZExPY3s.js";import{H as J}from"./Profilepage-BbrdSlK4.js";import{N as V}from"./Navbar-jeyIKQHE.js";import{d as X,e as Y,u as Z,f as ee}from"./apiItem-DywGHsb8.js";import{C as L}from"./Close-enXtLeST.js";import{M as U}from"./Modal-DNgNV9RL.js";import{I as x}from"./input-DElTaC0g.js";import{L as d}from"./label-DHr99d9d.js";import{P as D}from"./Docspage-DcoY3HsE.js";import"./UserAvatar-etQ40MIc.js";function P(a){const t=new Date(a),s=new Date;return Math.ceil((t.getTime()-s.getTime())/(1e3*60*60*24))}function c({field:a,fieldName:t,suffix:s,small:l}){return e.jsxs(Q,{className:f("flex justify-between items-center",l?"text-sm":"text-md"),children:[e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[t," :"," "]}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[a||e.jsx(R,{children:"NA"}),s]})]})}function se({className:a,item:t,small:s,barebone:l=!1,viewMorePath:p}){const[g,h]=j.useState(!1);return e.jsxs("div",{className:f("relative duration-100 aspect-square transform-3d shadow-2xl",g?"rotate-y-180":"rotate-y-0",s?"w-xs":"w-md",a),children:[e.jsxs(y,{className:f("h-full w-full flex flex-col justify-center items-center p-4 gap-2 absolute top-0 left-0 rotate-y-180",g?"z-20":"z-0"),children:[e.jsx(w,{className:"w-full text-center",children:e.jsx(S,{className:"jet-brains",children:"Scan Me"})}),e.jsx(C,{className:f("flex flex-col justify-between",s?"h-60 w-60":"h-90 w-90"),children:e.jsx("img",{src:`https://encode.ravishdev.org/api/create/text_url?text_url=http://localhost:5173/item/${t?.SKU}&fg=%2368a872&bg=%230e2033`,alt:t?.name.substring(0,10),className:"w-full rounded-2xl"})}),e.jsx(b,{className:"w-full px-0",children:e.jsx(o,{onClick:()=>h(!1),className:"w-full",children:"Show Information"})})]}),e.jsx("div",{className:"h-full w-full bg-ls-bg-300 dark:bg-ls-bg-dark-800 rounded-2xl"}),e.jsxs(y,{className:f("h-full w-full flex flex-col justify-between p-4 absolute top-0 left-0 gap-2",g?"z-0":"z-20"),children:[e.jsxs(w,{className:"w-full h-min ",children:[e.jsx(S,{className:"text-center jet-brains",children:t?.SKU?.substring(25)}),t.expiresOn&&P(t.expiresOn)<=15&&e.jsxs("div",{className:f("bg-ls-sec-400 dark:bg-ls-sec-900 rounded-lg w-full flex items-center justify-center gap-1 jet-brains",s?"p-1 text-sm":"p-1 text-md"),children:[e.jsx(J,{})," item exipres in"," ",P(t.expiresOn)," days"]})]}),e.jsxs(C,{className:"w-full h-full gap-2 flex flex-col overflow-y-auto p-4 rounded-2xl",children:[e.jsx(c,{small:s,field:t.name,fieldName:"Name"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.inventoryCategory,fieldName:"Category"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.origin,fieldName:"Origin"}),t?.expiresOn&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:new Date(t.expiresOn).toLocaleDateString(),fieldName:"Expires On"})]}),!l&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.costPrice,fieldName:"Cost Price",suffix:" /-"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.sellingPrice,fieldName:"Selling Price",suffix:" /-"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.quantity,fieldName:"Quantity",suffix:" units"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:new Date(t.importedOn).toLocaleDateString(),fieldName:"Imported On"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.colour,fieldName:"Colour"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.weight,fieldName:"Weight"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.importance,fieldName:"Importance"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.reorderLevel,fieldName:"Reorder Level"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.batchNumber,fieldName:"Batch Number"})]})]}),e.jsx(b,{className:"w-full flex flex-col justify-between px-0 gap-2",children:e.jsxs("div",{className:"w-full grid grid-cols-2 gap-2",children:[e.jsx(o,{onClick:()=>h(!0),className:"w-full",children:"Show Qrcode"}),e.jsx(G,{to:p||"/authenticate",className:"w-full",children:e.jsx(o,{className:"w-full",children:"More About Item"})})]})})]})]})}function te(a){const{data:t,isPending:s}=k({queryKey:["item"],queryFn:()=>X(a)});return{item:t,isPending:s}}function re(){const a=F(),{mutate:t,isPending:s}=M({mutationFn:Y,onSuccess:()=>{a.invalidateQueries({predicate:l=>l.queryKey[0]?.toString()==="items"}),m.success("Item deleted successfully",{className:"toast"})},onError:l=>{m.error(l.message,{className:"toast"})}});return{deleteItemFn:t,isPending:s}}function ne({open:a,setOpen:t,itemData:s}){const[l,p]=j.useState(""),g=E(),{deleteItemFn:h,isPending:r}=re();return e.jsx(U,{openModal:a,children:e.jsxs(y,{children:[e.jsxs(w,{className:"flex justify-between items-center",children:[e.jsx(q,{children:"Remove Item"}),e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:e.jsx(L,{})})]}),e.jsxs(C,{className:"grid gap-4",children:[e.jsxs(O,{children:["Item's Name : ",s.name]}),e.jsxs(O,{children:["Item's SKU : ",s.SKU?.substring(25)]}),e.jsxs(d,{title:"remove item",htmlFor:"removeitem",className:"grid",children:[e.jsxs("span",{children:['Enter "',e.jsxs("span",{className:"text-red-500",children:["remove ",s.name]}),'" in the input below to remove item']}),e.jsx(x,{placeholder:"Enter Text",type:"text",value:l,name:"name",required:!0,className:"text-sm md:text-md",onChange:i=>p(i.target.value)})]})]}),e.jsxs(b,{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:()=>{h(s._id),p(""),t(!1),g(-1)},disabled:r||l.trim()!==`remove ${s.name}`,variant:"destructive",children:"Remove Item"})]})]})})}function ae(){const a=F(),{mutate:t,isPending:s}=M({mutationFn:Z,onSuccess:()=>{a.invalidateQueries({predicate:l=>l.queryKey[0]?.toString().startsWith("item")||!1}),m.success("Item updated successfully",{className:"toast"})},onError:l=>{m.error(l.message,{className:"toast"})}});return{updateItemFn:t,isPending:s}}function ie(a,t){if(!t)return t;switch(a){case"KG":return t*1e3;case"MG":return t/1e3;default:return t}}function le({open:a,setOpen:t,item:s}){const{isPending:l,updateItemFn:p}=ae(),[g,h]=j.useState("G"),[r,i]=j.useState({name:s.name,costPrice:s.costPrice,sellingPrice:s.sellingPrice,quantify:s.quantity,inventoryCategory:s.inventoryCategory,importance:s.importance||"C",importedOn:new Date(s.importedOn).toISOString(),expiresOn:new Date(s.expiresOn).toISOString(),weight:s.weight,colour:s.colour,reorderLevel:s.reorderLevel,origin:s.origin}),v=()=>{if(r.name.trim()==="")return m.warning("Item should have a name",{className:"toast"});if(r.costPrice<=0)return m.warning("Cost price can't be 0",{className:"toast"});if(r.sellingPrice<=0)return m.warning("Selling price can't be 0",{className:"toast"});if(r.quantify<=0)return m.warning("Quantity can't be 0",{className:"toast"});if(r.inventoryCategory.trim()==="")return m.warning("Category of item is required",{className:"toast"});if(!["A","B","C"].includes(r.importance.trim()))return m.warning("Item importance is invalid",{className:"toast"});if(new Date(r.importedOn)>new Date)return m.warning("Imported data can't be in future",{className:"toast"});if(r.weight&&r.weight<=0)return m.warning("Item can't be weightless",{className:"toast"});const n=JSON.parse(JSON.stringify(r));n.weight=ie(g,r.weight),n.name=n.name.trim(),n.inventoryCategory=n.inventoryCategory.trim(),n.colour=n.colour?.trim(),n.origin=n.origin?.trim(),p({itemId:s._id,newItem:n}),t(!1)};return e.jsx(U,{openModal:a,children:e.jsxs(y,{className:"min-w-lg max-w-screen",children:[e.jsxs(w,{className:"flex justify-between items-center",children:[e.jsx(q,{children:"Update item"}),e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:e.jsx(L,{})})]}),e.jsxs(C,{className:"grid gap-2 max-h-96 overflow-auto",children:[e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"name",className:"grid",children:[e.jsx("span",{children:"Name"}),e.jsx(x,{id:"name",name:"name",type:"text",value:r.name,onChange:n=>i({...r,name:n.target.value}),placeholder:"Enter item's name"})]}),e.jsxs(d,{htmlFor:"inventory-category",className:"grid",children:[e.jsx("span",{children:"Inventory Category"}),e.jsx(x,{id:"inventory-category",name:"inventoryCategory",type:"text",value:r.inventoryCategory,onChange:n=>i({...r,inventoryCategory:n.target.value}),placeholder:"Enter item's inventory category"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"costprice",className:"grid",children:[e.jsx("span",{children:"Cost Price"}),e.jsx(x,{id:"costprice",name:"costPrice",type:"number",value:r.costPrice,min:0,onChange:n=>i({...r,costPrice:Number(n.target.value)}),placeholder:"Enter item cost price",required:!0})]}),e.jsxs(d,{htmlFor:"sellingprice",className:"grid",children:[e.jsx("span",{children:"Selling Price"}),e.jsx(x,{id:"sellingprice",name:"sellingPrice",type:"number",value:r.sellingPrice,onChange:n=>i({...r,sellingPrice:Number(n.target.value)}),placeholder:"Enter item selling price",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"quantity",className:"grid",children:[e.jsx("span",{children:"Quantity"}),e.jsx(x,{id:"quantity",name:"quantity",type:"number",value:r.quantify,onChange:n=>i({...r,quantify:Number(n.target.value)}),placeholder:"Enter item quantity",required:!0})]}),e.jsxs("div",{className:"flex gap-2 items-end w-full",children:[e.jsxs(d,{htmlFor:"weight",className:"grid w-full",children:[e.jsx("span",{children:"Weight"}),e.jsx(x,{id:"weight",name:"weight",type:"number",min:1,value:r.weight,onChange:n=>i({...r,weight:Number(n.target.value)}),placeholder:"Enter item's weight"})]}),e.jsxs(z,{children:[e.jsx(H,{asChild:!0,children:e.jsx(o,{variant:"outline",children:g})}),e.jsx(W,{children:e.jsx(_,{defaultValue:g,onValueChange:n=>h(n),children:["KG","G","MG"].map((n,N)=>e.jsx($,{value:n,children:n},N))})})]})]})]}),e.jsxs(d,{htmlFor:"importance",className:"grid",children:[e.jsx("span",{children:"Importance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(o,{onClick:()=>i({...r,importance:"A"}),variant:r.importance==="A"?"secondary":"outline",className:"rounded-e-none",children:"A"}),e.jsx(o,{onClick:()=>i({...r,importance:"B"}),variant:r.importance==="B"?"secondary":"outline",className:"rounded-s-none rounded-e-none",children:"B"}),e.jsx(o,{onClick:()=>i({...r,importance:"C"}),variant:r.importance==="C"?"secondary":"outline",className:"rounded-s-none",children:"C"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"importedon",className:"grid",children:[e.jsx("span",{children:"Imported On"}),e.jsx(x,{id:"importedon",name:"importedOn",type:"date",value:new Date(r.importedOn).toISOString().split("T")[0],max:r.expiresOn?new Date(r.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:n=>{i({...r,importedOn:new Date(n.target.valueAsDate||r.importedOn).toISOString()})},placeholder:"Enter item's imported date",className:"w-full",required:!0})]}),e.jsxs(d,{htmlFor:"expireson",className:"grid",children:[e.jsx("span",{children:"Expires On"}),e.jsx(x,{id:"expireson",name:"expiresOn",type:"date",value:r.expiresOn?new Date(r.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],min:new Date(r.importedOn).toISOString().split("T")[0],onChange:n=>{i({...r,expiresOn:n.target.valueAsDate?new Date(n.target.valueAsDate).toISOString():void 0})},placeholder:"Enter item's expiry date",className:"w-full"})]})]}),e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"colour",className:"grid",children:[e.jsx("span",{children:"Colour"}),e.jsx(x,{id:"colour",name:"colour",type:"text",value:r.colour,onChange:n=>i({...r,colour:n.target.value}),placeholder:"Enter item's colour"})]}),e.jsxs(d,{htmlFor:"origin",className:"grid",children:[e.jsx("span",{children:"Origin Place"}),e.jsx(x,{id:"origin",name:"origin",type:"text",value:r.origin,onChange:n=>i({...r,origin:n.target.value}),placeholder:"Enter item's origin place"})]})]}),e.jsx("div",{className:"grid gap-2 grid-cols-2",children:e.jsxs(d,{htmlFor:"reorderlevel",className:"grid",children:[e.jsx("span",{children:"Re-Order Level"}),e.jsx(x,{id:"reorderlevel",name:"reorderLevel",type:"number",min:0,value:r.reorderLevel,onChange:n=>i({...r,reorderLevel:Number(n.target.value)}),placeholder:"Enter item's re-order level"})]})})]}),e.jsxs(b,{className:"flex gap-2",children:[e.jsx(o,{type:"button",onClick:()=>t(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:v,disabled:l,children:"Update Item"})]})]})})}function oe(a){const{data:t,isPending:s}=k({queryKey:["employee-status"],queryFn:()=>ee(a)});return{isEmployee:t,isPending:s}}function we(){const{SKU:a,orgSlug:t}=K();(!a||!t)&&m.error("Item not found",{className:"toast"});const{item:s,isPending:l}=te(a||""),{user:p,isPending:g}=A(),{isEmployee:h,isPending:r}=oe(t||""),i=p?.user,v=E(),[n,N]=j.useState(!1),[T,I]=j.useState(!1);return l||g||r?e.jsx(B,{}):e.jsxs("div",{className:"flex flex-col gap-3 items-center bg-ls-bg-300 dark:bg-ls-bg-dark-800 min-h-screen relative",children:[e.jsx(V,{hide:{userButton:!0}}),s?e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>v(-1),children:[e.jsx(D,{})," Go Back"]}),e.jsxs("div",{className:"grid gap-2 p-2 outline-1 rounded-2xl items-center",children:[e.jsx(se,{item:s,viewMorePath:i?"/dashboard":"/authenticate",barebone:!h}),i&&e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx(o,{variant:"secondary",className:"flex-1",onClick:()=>I(!0),children:"Edit Item Data"}),e.jsx(o,{variant:"destructive",className:"flex-1",onClick:()=>N(!0),children:"Delete Data"}),e.jsx(ne,{open:n,setOpen:N,itemData:s}),e.jsx(le,{open:T,setOpen:I,item:s})]})]}),e.jsx("div",{className:"w-20"})]}):e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>v(-1),children:[e.jsx(D,{})," Go Back"]}),e.jsx("div",{className:"grid place-items-center gap-2 p-2 min-w-md outline-1 rounded-2xl items-center",children:"Not Item Found"}),e.jsx("div",{className:"w-20"})]})]})}export{we as default};
