import{r as j,j as e,c as I,L as K,a as k,u as E,y as m,e as q,b as A,f as B,g as Q}from"./index-OmV3yq9G.js";import{C as N,a as y,c as w,d as C,b as M}from"./card-DDFRYrzS.js";import{b as S,B as o,M as R,u as L,S as O}from"./button-9vMW9_oR.js";import{S as u,D as H,a as W,b as _,j as z,k as $}from"./separator-DYVVEmrN.js";import{H as J}from"./Profilepage-ngNGz7hp.js";import{f as D,p as V}from"./utilfn-hU4X3vrN.js";import{N as Y}from"./Navbar-Bpyp0QFV.js";import{d as X,e as Z,u as ee,f as se}from"./apiItem-DSGlJ6aq.js";import{C as U}from"./Close-C8HdlCrP.js";import{M as T}from"./Modal-DM6aciIk.js";import{I as x}from"./input-DYqCBqzr.js";import{L as d}from"./label-DMqxW8Nh.js";import{P}from"./Docspage-B26Q-lQl.js";import"./UserAvatar-D16AkYtt.js";function F(a){const t=new Date(a),s=new Date;return Math.ceil((t.getTime()-s.getTime())/(1e3*60*60*24))}function c({field:a,fieldName:t,suffix:s,small:i}){return e.jsxs("div",{className:I("flex justify-between items-center",i?"text-xs":"text-sm"),children:[e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[t," :"," "]}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[a||e.jsx(R,{children:"NA"}),s]})]})}function te({className:a,item:t,small:s,barebone:i=!1,viewMorePath:h}){const[p,g]=j.useState(!1);return e.jsxs("div",{className:I("aspect-square w-2xs sm:w-xs md:w-sm max-w-11/12 outline-none duration-1000 [perspective:10rem] transform-3d",p&&"[transform:rotateY(180deg)]",s?"max-w-xs":"max-w-md",a),children:[e.jsxs(N,{className:"inset-0 p-2 md:p-4 gap-2 absolute [backface-visibility:hidden]",children:[e.jsxs(y,{className:"w-full h-min ",children:[e.jsx(S,{className:"text-center jet-brains",children:t?.SKU?.substring(25)}),t.expiresOn&&F(t.expiresOn)<=15&&e.jsxs("div",{className:I("bg-ls-sec-400 dark:bg-ls-sec-900 rounded-lg w-full flex items-center justify-center gap-1 jet-brains",s?"p-1 text-sm":"p-1 text-md"),children:[e.jsx(J,{})," item exipres in"," ",F(t.expiresOn)," days"]})]}),e.jsxs(w,{className:"w-full h-90 gap-2 grid overflow-y-auto scrollbar p-2 md:p-4 rounded-2xl",children:[e.jsx(c,{small:s,field:t.name,fieldName:"Name"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.inventoryCategory,fieldName:"Category"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.origin,fieldName:"Origin"}),t?.expiresOn&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:new Date(t.expiresOn).toLocaleDateString(),fieldName:"Expires On"})]}),!i&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:D(t.costPrice),fieldName:"Cost Price",suffix:" /-"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:D(t.sellingPrice),fieldName:"Selling Price",suffix:" /-"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.quantity,fieldName:"Quantity",suffix:" units"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:new Date(t.importedOn).toLocaleDateString(),fieldName:"Imported On"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.colour,fieldName:"Colour"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.weight&&V(t.weight),fieldName:"Weight"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.importance,fieldName:"Importance"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.reorderLevel,fieldName:"Reorder Level"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:t.batchNumber,fieldName:"Batch Number"})]})]}),e.jsxs(C,{className:"grid grid-cols-2 gap-1 p-0 md:p-0",children:[e.jsx(o,{onClick:()=>g(!0),className:"col-span-1 w-full",size:"sm",children:"Show Qrcode"}),e.jsx(K,{to:h||"/authenticate",className:"col-span-1",children:e.jsxs(o,{className:"w-full",size:"sm",children:["More ",e.jsx("span",{className:"hidden sm:flex",children:"About Item"})]})})]})]}),e.jsxs(N,{className:"inset-0 size-full p-2 md:p-4 gap-2 absolute [backface-visibility:hidden] [transform:rotateY(180deg)]",children:[e.jsx(y,{className:"w-full text-center",children:e.jsx(S,{className:"jet-brains",children:"Scan Me"})}),e.jsx(w,{className:"grid place-items-center",children:e.jsx("img",{src:`https://encode.ravishdev.org/api/create/text_url?text_url=${window.location.origin||"http://localhost:5173"}/item/${t?.SKU}&fg=%2368a872&bg=%230e2033`,alt:t?.name.substring(0,10),className:"rounded-2xl md:max-w-10/12 max-w-2/3"})}),e.jsx(C,{className:"w-full p-0 md:p-0",children:e.jsx(o,{onClick:()=>g(!1),className:"w-full",children:"Show Information"})})]})]})}function re(a){const{data:t,isPending:s}=k({queryKey:["item"],queryFn:()=>X(a),staleTime:0});return{item:t,isPending:s}}function ne(){const a=E(),{mutate:t,isPending:s}=L({mutationFn:Z,onSuccess:()=>{a.invalidateQueries({predicate:i=>i.queryKey[0]?.toString()==="items"}),m.success("Item deleted successfully",{className:"toast"})},onError:i=>{m.error(i.message,{className:"toast"})}});return{deleteItemFn:t,isPending:s}}function ae({open:a,setOpen:t,itemData:s}){const[i,h]=j.useState(""),p=q(),{deleteItemFn:g,isPending:n}=ne();return e.jsx(T,{openModal:a,children:e.jsxs(N,{className:"w-11/12 sm:max-w-sm",children:[e.jsxs(y,{className:"flex justify-between items-center",children:[e.jsx(M,{children:"Remove Item"}),e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:e.jsx(U,{})})]}),e.jsxs(w,{className:"grid gap-4",children:[e.jsxs(O,{children:["Item's Name : ",s.name]}),e.jsxs(O,{children:["Item's SKU : ",s.SKU?.substring(25)]}),e.jsxs(d,{title:"remove item",htmlFor:"removeitem",className:"grid",children:[e.jsxs("span",{children:['Enter "',e.jsxs("span",{className:"text-red-500",children:["remove ",s.name]}),'" in the input below to remove item']}),e.jsx(x,{placeholder:"Enter Text",type:"text",value:i,name:"name",required:!0,className:"text-sm md:text-md",onChange:l=>h(l.target.value)})]})]}),e.jsxs(C,{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:()=>{g(s._id),t(!1),h(""),p(-1)},disabled:n||i.trim()!==`remove ${s.name}`,variant:"destructive",children:"Remove Item"})]})]})})}function ie(){const a=E(),{mutate:t,isPending:s}=L({mutationFn:ee,onSuccess:()=>{a.invalidateQueries({predicate:i=>i.queryKey[0]?.toString().startsWith("item")||!1}),m.success("Item updated successfully",{className:"toast"})},onError:i=>{m.error(i.message,{className:"toast"})}});return{updateItemFn:t,isPending:s}}function le(a,t){if(!t)return t;switch(a){case"KG":return t*1e3;case"MG":return t/1e3;default:return t}}function oe({open:a,setOpen:t,item:s}){const{isPending:i,updateItemFn:h}=ie(),[p,g]=j.useState("G"),[n,l]=j.useState({name:s.name,costPrice:s.costPrice,sellingPrice:s.sellingPrice,quantify:s.quantity,inventoryCategory:s.inventoryCategory,importance:s.importance||"C",importedOn:new Date(s.importedOn).toISOString(),expiresOn:s.expiresOn?new Date(s.expiresOn).toISOString():new Date().toISOString(),weight:s.weight,colour:s.colour,reorderLevel:s.reorderLevel,origin:s.origin}),f=()=>{if(n.name.trim()==="")return m.warning("Item should have a name",{className:"toast"});if(n.costPrice<=0)return m.warning("Cost price can't be 0",{className:"toast"});if(n.sellingPrice<=0)return m.warning("Selling price can't be 0",{className:"toast"});if(n.quantify<=0)return m.warning("Quantity can't be 0",{className:"toast"});if(n.inventoryCategory.trim()==="")return m.warning("Category of item is required",{className:"toast"});if(!["A","B","C"].includes(n.importance.trim()))return m.warning("Item importance is invalid",{className:"toast"});if(new Date(n.importedOn)>new Date)return m.warning("Imported data can't be in future",{className:"toast"});if(n.weight&&n.weight<=0)return m.warning("Item can't be weightless",{className:"toast"});const r=JSON.parse(JSON.stringify(n));r.weight=le(p,n.weight),r.name=r.name.trim(),r.inventoryCategory=r.inventoryCategory.trim(),r.colour=r.colour?.trim(),r.origin=r.origin?.trim(),h({itemId:s._id,newItem:r}),t(!1)};return e.jsx(T,{openModal:a,children:e.jsxs(N,{className:"w-md max-w-11/12",children:[e.jsxs(y,{className:"flex justify-between items-center",children:[e.jsx(M,{children:"Update item"}),e.jsx(o,{onClick:()=>t(!1),variant:"secondary",children:e.jsx(U,{})})]}),e.jsxs(w,{className:"grid gap-2 max-h-96 overflow-auto",children:[e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"name",className:"grid",children:[e.jsx("span",{children:"Name"}),e.jsx(x,{id:"name",name:"name",type:"text",value:n.name,onChange:r=>l({...n,name:r.target.value}),placeholder:"Enter item's name"})]}),e.jsxs(d,{htmlFor:"inventory-category",className:"grid",children:[e.jsx("span",{children:"Inventory Category"}),e.jsx(x,{id:"inventory-category",name:"inventoryCategory",type:"text",value:n.inventoryCategory,onChange:r=>l({...n,inventoryCategory:r.target.value}),placeholder:"Enter item's inventory category"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"costprice",className:"grid",children:[e.jsx("span",{children:"Cost Price"}),e.jsx(x,{id:"costprice",name:"costPrice",type:"number",onFocus:r=>r.target.select(),value:n.costPrice,min:0,onChange:r=>l({...n,costPrice:Number(r.target.value)}),placeholder:"Enter item cost price",required:!0})]}),e.jsxs(d,{htmlFor:"sellingprice",className:"grid",children:[e.jsx("span",{children:"Selling Price"}),e.jsx(x,{id:"sellingprice",name:"sellingPrice",type:"number",onFocus:r=>r.target.select(),value:n.sellingPrice,onChange:r=>l({...n,sellingPrice:Number(r.target.value)}),placeholder:"Enter item selling price",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"quantity",className:"grid",children:[e.jsx("span",{children:"Quantity"}),e.jsx(x,{id:"quantity",name:"quantity",type:"number",onFocus:r=>r.target.select(),value:n.quantify,onChange:r=>l({...n,quantify:Number(r.target.value)}),placeholder:"Enter item quantity",required:!0})]}),e.jsxs("div",{className:"flex gap-2 items-end w-full",children:[e.jsxs(d,{htmlFor:"weight",className:"grid w-full",children:[e.jsx("span",{children:"Weight"}),e.jsx(x,{id:"weight",name:"weight",type:"number",onFocus:r=>r.target.select(),min:1,value:n.weight,onChange:r=>l({...n,weight:Number(r.target.value)}),placeholder:"Enter item's weight"})]}),e.jsxs(H,{children:[e.jsx(W,{asChild:!0,children:e.jsx(o,{variant:"outline",children:p})}),e.jsx(_,{children:e.jsx(z,{defaultValue:p,onValueChange:r=>g(r),children:["KG","G","MG"].map((r,v)=>e.jsx($,{value:r,children:r},v))})})]})]})]}),e.jsxs(d,{htmlFor:"importance",className:"grid",children:[e.jsx("span",{children:"Importance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(o,{onClick:()=>l({...n,importance:"A"}),variant:n.importance==="A"?"secondary":"outline",className:"rounded-e-none",children:"A"}),e.jsx(o,{onClick:()=>l({...n,importance:"B"}),variant:n.importance==="B"?"secondary":"outline",className:"rounded-s-none rounded-e-none",children:"B"}),e.jsx(o,{onClick:()=>l({...n,importance:"C"}),variant:n.importance==="C"?"secondary":"outline",className:"rounded-s-none",children:"C"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"importedon",className:"grid",children:[e.jsx("span",{children:"Imported On"}),e.jsx(x,{id:"importedon",name:"importedOn",type:"date",value:new Date(n.importedOn).toISOString().split("T")[0],max:n.expiresOn?new Date(n.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:r=>{l({...n,importedOn:new Date(r.target.valueAsDate||n.importedOn).toISOString()})},placeholder:"Enter item's imported date",className:"w-full",required:!0})]}),e.jsxs(d,{htmlFor:"expireson",className:"grid",children:[e.jsx("span",{children:"Expires On"}),e.jsx(x,{id:"expireson",name:"expiresOn",type:"date",value:n.expiresOn?new Date(n.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],min:new Date(n.importedOn).toISOString().split("T")[0],onChange:r=>{l({...n,expiresOn:r.target.valueAsDate?new Date(r.target.valueAsDate).toISOString():void 0})},placeholder:"Enter item's expiry date",className:"w-full"})]})]}),e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"colour",className:"grid",children:[e.jsx("span",{children:"Colour"}),e.jsx(x,{id:"colour",name:"colour",type:"text",value:n.colour,onChange:r=>l({...n,colour:r.target.value}),placeholder:"Enter item's colour"})]}),e.jsxs(d,{htmlFor:"origin",className:"grid",children:[e.jsx("span",{children:"Origin Place"}),e.jsx(x,{id:"origin",name:"origin",type:"text",value:n.origin,onChange:r=>l({...n,origin:r.target.value}),placeholder:"Enter item's origin place"})]})]}),e.jsx("div",{className:"grid gap-2 grid-cols-2",children:e.jsxs(d,{htmlFor:"reorderlevel",className:"grid",children:[e.jsx("span",{children:"Re-Order Level"}),e.jsx(x,{id:"reorderlevel",name:"reorderLevel",type:"number",onFocus:r=>r.target.select(),min:0,value:n.reorderLevel,onChange:r=>l({...n,reorderLevel:Number(r.target.value)}),placeholder:"Enter item's re-order level"})]})})]}),e.jsxs(C,{className:"flex gap-2",children:[e.jsx(o,{type:"button",onClick:()=>t(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:f,disabled:i,children:"Update Item"})]})]})})}function ce(a){const{data:t,isPending:s}=k({queryKey:["employee-status"],queryFn:()=>se(a)});return{isEmployee:t,isPending:s}}function Ie(){const{SKU:a,orgSlug:t}=A();(!a||!t)&&m.error("Item not found",{className:"toast"});const{item:s,isPending:i}=re(a||""),{user:h,isPending:p}=B(),{isEmployee:g,isPending:n}=ce(t||""),l=h?.user,f=q(),[r,v]=j.useState(!1),[G,b]=j.useState(!1);return i||p||n?e.jsx(Q,{}):e.jsxs("div",{className:"flex flex-col justify-start gap-3 items-center bg-ls-bg-300 dark:bg-ls-bg-dark-800 min-h-dvh relative",children:[e.jsx(Y,{hide:{userButton:!0},children:e.jsxs(o,{variant:"outline",onClick:()=>f(-1),children:[e.jsx(P,{})," ",e.jsx("span",{className:"hidden sm:flex",children:"Go Back"})]})}),s?e.jsxs("main",{className:"grid gap-2 p-2 rounded-2xl items-center place-items-center",children:[e.jsx(te,{item:s,viewMorePath:l?"/dashboard":"/authenticate",barebone:!g}),!!g&&e.jsxs("div",{className:"flex w-full gap-1",children:[e.jsx(o,{variant:"secondary",className:"flex-1",onClick:()=>b(!0),children:"Edit Item Data"}),e.jsx(o,{variant:"destructive",className:"flex-1",onClick:()=>v(!0),children:"Delete Data"}),e.jsx(ae,{open:r,setOpen:v,itemData:s}),e.jsx(oe,{open:G,setOpen:b,item:s})]})]}):e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>f(-1),children:[e.jsx(P,{})," Go Back"]}),e.jsx("div",{className:"grid place-items-center gap-2 p-2 min-w-md outline-1 rounded-2xl items-center",children:"Not Item Found"}),e.jsx("div",{className:"w-20"})]})]})}export{Ie as default};
