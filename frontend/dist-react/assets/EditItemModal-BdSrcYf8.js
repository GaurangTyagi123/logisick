import{c as v,y as o,r as u,j as e}from"./index-D0_Sot9h.js";import{C as y}from"./Close-5X7b8tAm.js";import{M as C}from"./Modal-DMArze6l.js";import{u as w,B as l}from"./button-BTAYK3jx.js";import{C as N,a as f,d as I,b as O,c as S}from"./card-uaHBxQ7j.js";import{D as b,a as F,b as D,t as q,v as P}from"./separator-Cmc26UhN.js";import{I as s}from"./input-CUKpUeOa.js";import{L as i}from"./label-D-KNEtrA.js";import{u as E}from"./apiItem-BA08D8KX.js";import{u as M}from"./utilfn-DLliPqnw.js";import"./Typography-BkeLtctd.js";function L(){const m=v(),{mutate:c,isPending:n}=w({mutationFn:E,onSuccess:()=>{m.invalidateQueries({predicate:d=>["item","items","items-report"].includes(d.queryKey[0]?.toString()||"")}),o.success("Item updated successfully",{className:"toast"})},onError:d=>{o.error(d.message,{className:"toast"})}});return{updateItemFn:c,isUpdatingItem:n}}function W({open:m,setOpen:c,item:n}){const{isUpdatingItem:d,updateItemFn:p}=L(),[g,h]=u.useState("G"),[t,a]=u.useState({name:n.name,costPrice:n.costPrice,sellingPrice:n.sellingPrice,quantity:n.quantity,inventoryCategory:n.inventoryCategory,importance:n.importance||"C",importedOn:new Date(n.importedOn).toISOString(),expiresOn:n.expiresOn?new Date(n.expiresOn).toISOString():"",weight:n.weight,colour:n.colour,reorderLevel:n.reorderLevel,origin:n.origin}),x=()=>{if(t.name.trim()==="")return o.warning("Item should have a name",{className:"toast"});if(t.costPrice<=0)return o.warning("Cost price can't be 0",{className:"toast"});if(t.sellingPrice<=0)return o.warning("Selling price can't be 0",{className:"toast"});if(t.quantity<=0)return o.warning("Quantity can't be 0",{className:"toast"});if(t.inventoryCategory.trim()==="")return o.warning("Category of item is required",{className:"toast"});if(!["A","B","C"].includes(t.importance.trim()))return o.warning("Item importance is invalid",{className:"toast"});if(new Date(t.importedOn)>new Date)return o.warning("Imported data can't be in future",{className:"toast"});if(t.weight&&t.weight<=0)return o.warning("Item can't be weightless",{className:"toast"});const r=JSON.parse(JSON.stringify(t));r.weight=M(g,t.weight),r.name=r.name.trim(),r.inventoryCategory=r.inventoryCategory.trim(),r.colour=r.colour?.trim(),r.origin=r.origin?.trim(),p({itemId:n._id,newItem:r}),c(!1)};return e.jsx(C,{openModal:m,children:e.jsxs(N,{className:"w-md max-w-11/12",children:[e.jsxs(f,{className:"flex justify-between items-center",children:[e.jsx(I,{children:"Update item"}),e.jsx(l,{onClick:()=>c(!1),variant:"secondary",children:e.jsx(y,{})})]}),e.jsxs(O,{className:"grid gap-2 max-h-96 overflow-auto",children:[e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(i,{htmlFor:"name",className:"grid",children:[e.jsx("span",{children:"Name"}),e.jsx(s,{id:"name",name:"name",type:"text",value:t.name,onChange:r=>a({...t,name:r.target.value}),placeholder:"Enter item's name"})]}),e.jsxs(i,{htmlFor:"inventory-category",className:"grid",children:[e.jsx("span",{children:"Inventory Category"}),e.jsx(s,{id:"inventory-category",name:"inventoryCategory",type:"text",value:t.inventoryCategory,onChange:r=>a({...t,inventoryCategory:r.target.value}),placeholder:"Enter item's inventory category"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(i,{htmlFor:"costprice",className:"grid",children:[e.jsx("span",{children:"Cost Price"}),e.jsx(s,{id:"costprice",name:"costPrice",type:"number",onFocus:r=>r.target.select(),value:t.costPrice,min:0,onChange:r=>a({...t,costPrice:Number(r.target.value)}),placeholder:"Enter item cost price",required:!0})]}),e.jsxs(i,{htmlFor:"sellingprice",className:"grid",children:[e.jsx("span",{children:"Selling Price"}),e.jsx(s,{id:"sellingprice",name:"sellingPrice",type:"number",onFocus:r=>r.target.select(),value:t.sellingPrice,onChange:r=>a({...t,sellingPrice:Number(r.target.value)}),placeholder:"Enter item selling price",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(i,{htmlFor:"quantity",className:"grid",children:[e.jsx("span",{children:"Quantity"}),e.jsx(s,{id:"quantity",name:"quantity",type:"number",onFocus:r=>r.target.select(),value:t.quantity,onChange:r=>a({...t,quantity:Number(r.target.value)}),placeholder:"Enter item quantity",required:!0})]}),e.jsxs("div",{className:"flex gap-2 items-end w-full",children:[e.jsxs(i,{htmlFor:"weight",className:"grid w-full",children:[e.jsx("span",{children:"Weight"}),e.jsx(s,{id:"weight",name:"weight",type:"number",onFocus:r=>r.target.select(),min:1,value:t.weight,onChange:r=>a({...t,weight:Number(r.target.value)}),placeholder:"Enter item's weight"})]}),e.jsxs(b,{children:[e.jsx(F,{asChild:!0,children:e.jsx(l,{variant:"outline",children:g})}),e.jsx(D,{children:e.jsx(q,{defaultValue:g,onValueChange:r=>h(r),children:["KG","G","MG","ML","L","KL"].map((r,j)=>e.jsx(P,{value:r,children:r},j))})})]})]})]}),e.jsxs(i,{htmlFor:"importance",className:"grid",children:[e.jsx("span",{children:"Importance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(l,{onClick:()=>a({...t,importance:"A"}),variant:t.importance==="A"?"secondary":"outline",className:"rounded-e-none",children:"A"}),e.jsx(l,{onClick:()=>a({...t,importance:"B"}),variant:t.importance==="B"?"secondary":"outline",className:"rounded-s-none rounded-e-none",children:"B"}),e.jsx(l,{onClick:()=>a({...t,importance:"C"}),variant:t.importance==="C"?"secondary":"outline",className:"rounded-s-none",children:"C"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(i,{htmlFor:"importedon",className:"grid",children:[e.jsx("span",{children:"Imported On"}),e.jsx(s,{id:"importedon",name:"importedOn",type:"date",value:new Date(t.importedOn).toISOString().split("T")[0],max:t.expiresOn?new Date(t.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:r=>{a({...t,importedOn:new Date(r.target.valueAsDate||t.importedOn).toISOString()})},placeholder:"Enter item's imported date",className:"w-full",required:!0})]}),e.jsxs(i,{htmlFor:"expireson",className:"grid",children:[e.jsx("span",{children:"Expires On"}),e.jsx(s,{id:"expireson",name:"expiresOn",type:"date",value:t.expiresOn?new Date(t.expiresOn).toISOString().split("T")[0]:"",min:new Date(t.importedOn).toISOString().split("T")[0],onChange:r=>{a({...t,expiresOn:r.target.valueAsDate?new Date(r.target.valueAsDate).toISOString():""})},placeholder:"Enter item's expiry date",className:"w-full"})]})]}),e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(i,{htmlFor:"colour",className:"grid",children:[e.jsx("span",{children:"Colour"}),e.jsx(s,{id:"colour",name:"colour",type:"text",value:t.colour,onChange:r=>a({...t,colour:r.target.value}),placeholder:"Enter item's colour"})]}),e.jsxs(i,{htmlFor:"origin",className:"grid",children:[e.jsx("span",{children:"Origin Place"}),e.jsx(s,{id:"origin",name:"origin",type:"text",value:t.origin,onChange:r=>a({...t,origin:r.target.value}),placeholder:"Enter item's origin place"})]})]}),e.jsx("div",{className:"grid gap-2 grid-cols-2",children:e.jsxs(i,{htmlFor:"reorderlevel",className:"grid",children:[e.jsx("span",{children:"Re-Order Level"}),e.jsx(s,{id:"reorderlevel",name:"reorderLevel",type:"number",onFocus:r=>r.target.select(),min:0,value:t.reorderLevel,onChange:r=>a({...t,reorderLevel:Number(r.target.value)}),placeholder:"Enter item's re-order level"})]})})]}),e.jsxs(S,{className:"flex gap-2",children:[e.jsx(l,{type:"button",onClick:()=>c(!1),variant:"secondary",children:"Cancel"}),e.jsx(l,{type:"button",onClick:x,disabled:d,children:"Update Item"})]})]})})}export{W as default};
