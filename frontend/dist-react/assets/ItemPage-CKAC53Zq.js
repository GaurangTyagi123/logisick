import{r as j,j as e,d as I,L as B,b as E,a as P,y as m,u as q,c as G,g as K,i as Q}from"./index-CNmL9Fba.js";import{C as N,a as y,c as w,d as C,b as M}from"./card-Br5fvIHU.js";import{b as S,B as o,M as R,u as L,S as O}from"./button-ozJThDYe.js";import{S as u,D as H,a as _,b as z,j as W,k as $}from"./separator-BvMHK9S3.js";import{H as J}from"./Profilepage-Bz5gTcBi.js";import{d as D,f as F,p as V,u as Y}from"./utilfn-VpFqLrdN.js";import{N as X}from"./Navbar-tXB-_T9S.js";import{d as Z,e as ee,u as se,f as te}from"./apiItem-_EpYx74s.js";import{C as U}from"./Close-D9iPeWNZ.js";import{M as A}from"./Modal-B4a1-HHj.js";import{I as x}from"./input-CR--nAY7.js";import{L as d}from"./label-BQg-PjmS.js";import{P as k}from"./Docspage-C_xerNsT.js";import"./UserAvatar-0quN_wyH.js";function c({field:n,fieldName:a,suffix:s,small:i}){return e.jsxs("div",{className:I("flex justify-between items-center",i?"text-xs":"text-sm"),children:[e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[a," :"," "]}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[n||e.jsx(R,{children:"NA"}),s]})]})}function re({className:n,item:a,small:s,barebone:i=!1,viewMorePath:h}){const[p,g]=j.useState(!1);return e.jsxs("div",{className:I("aspect-square w-2xs sm:w-xs md:w-sm max-w-11/12 outline-none duration-1000 [perspective:10rem] transform-3d",p&&"[transform:rotateY(180deg)]",s?"max-w-xs":"max-w-md",n),children:[e.jsxs(N,{className:"inset-0 p-2 md:p-4 gap-2 absolute [backface-visibility:hidden]",children:[e.jsxs(y,{className:"w-full h-min ",children:[e.jsx(S,{className:"text-center jet-brains",children:a?.SKU?.substring(25)}),a.expiresOn&&D(a.expiresOn)<=15&&e.jsxs("div",{className:I("bg-ls-sec-400 dark:bg-ls-sec-900 rounded-lg w-full flex items-center justify-center gap-1 jet-brains",s?"p-1 text-sm":"p-1 text-md"),children:[e.jsx(J,{})," item exipres in"," ",D(a.expiresOn)," days"]})]}),e.jsxs(w,{className:"w-full h-90 gap-2 grid overflow-y-auto scrollbar p-2 md:p-4 rounded-2xl",children:[e.jsx(c,{small:s,field:a.name,fieldName:"Name"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.inventoryCategory,fieldName:"Category"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.origin,fieldName:"Origin"}),a?.expiresOn&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:new Date(a.expiresOn).toLocaleDateString(),fieldName:"Expires On"})]}),!i&&e.jsxs(e.Fragment,{children:[!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:F(a.costPrice),fieldName:"Cost Price",suffix:" /-"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:F(a.sellingPrice),fieldName:"Selling Price",suffix:" /-"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.quantity,fieldName:"Quantity",suffix:" units"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:new Date(a.importedOn).toLocaleDateString(),fieldName:"Imported On"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.colour,fieldName:"Colour"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.weight&&V(a.weight),fieldName:"Weight"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.importance,fieldName:"Importance"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.reorderLevel,fieldName:"Reorder Level"}),!s&&e.jsx(u,{}),e.jsx(c,{small:s,field:a.batchNumber,fieldName:"Batch Number"})]})]}),e.jsxs(C,{className:"grid grid-cols-2 gap-1 p-0 md:p-0",children:[e.jsx(o,{onClick:()=>g(!0),className:"col-span-1 w-full",size:"sm",children:"Show Qrcode"}),e.jsx(B,{to:h||"/authenticate",className:"col-span-1",children:e.jsxs(o,{className:"w-full",size:"sm",children:["More ",e.jsx("span",{className:"hidden sm:flex",children:"About Item"})]})})]})]}),e.jsxs(N,{className:"inset-0 size-full p-2 md:p-4 gap-2 absolute [backface-visibility:hidden] [transform:rotateY(180deg)]",children:[e.jsx(y,{className:"w-full text-center",children:e.jsx(S,{className:"jet-brains",children:"Scan Me"})}),e.jsx(w,{className:"grid place-items-center",children:e.jsx("img",{src:`https://encode.ravishdev.org/api/create/text_url?text_url=${window.location.origin||"http://localhost:5173"}/item/${a?.SKU}&fg=%2368a872&bg=%230e2033`,alt:a?.name.substring(0,10),className:"rounded-2xl md:max-w-10/12 max-w-2/3"})}),e.jsx(C,{className:"w-full p-0 md:p-0",children:e.jsx(o,{onClick:()=>g(!1),className:"w-full",children:"Show Information"})})]})]})}function ae(n){const{data:a,isPending:s}=E({queryKey:["item",n],queryFn:()=>Z(n),staleTime:0});return{item:a,isGettingItem:s}}function ne(){const n=P(),{mutate:a,isPending:s}=L({mutationFn:ee,onSuccess:()=>{n.invalidateQueries({predicate:i=>["items","items-report"].includes(i.queryKey[0]?.toString()||"")}),m.success("Item deleted successfully",{className:"toast"})},onError:i=>{m.error(i.message,{className:"toast"})}});return{deleteItemFn:a,isDeletingItem:s}}function ie({open:n,setOpen:a,itemData:s}){const[i,h]=j.useState(""),p=q(),{deleteItemFn:g,isDeletingItem:r}=ne();return e.jsx(A,{openModal:n,children:e.jsxs(N,{className:"w-md max-w-11/12",children:[e.jsxs(y,{className:"flex justify-between items-center",children:[e.jsx(M,{children:"Remove Item"}),e.jsx(o,{onClick:()=>a(!1),variant:"secondary",children:e.jsx(U,{})})]}),e.jsxs(w,{className:"grid gap-4",children:[e.jsxs(O,{children:["Item's Name : ",s.name]}),e.jsxs(O,{children:["Item's SKU : ",s.SKU?.substring(25)]}),e.jsxs(d,{title:"remove item",htmlFor:"removeitem",className:"grid",children:[e.jsxs("span",{children:['Enter "',e.jsxs("span",{className:"text-red-500",children:["remove ",s.name]}),'" in the input below to remove item']}),e.jsx(x,{placeholder:"Enter Text",type:"text",value:i,name:"name",required:!0,className:"text-sm md:text-md",onChange:l=>h(l.target.value)})]})]}),e.jsxs(C,{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>a(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:()=>{g(s._id),a(!1),h(""),p(-1)},disabled:r||i.trim()!==`remove ${s.name}`,variant:"destructive",children:"Remove Item"})]})]})})}function le(){const n=P(),{mutate:a,isPending:s}=L({mutationFn:se,onSuccess:()=>{n.invalidateQueries({predicate:i=>["items","items-report"].includes(i.queryKey[0]?.toString()||"")}),m.success("Item updated successfully",{className:"toast"})},onError:i=>{m.error(i.message,{className:"toast"})}});return{updateItemFn:a,isUpdatingItem:s}}function oe({open:n,setOpen:a,item:s}){const{isUpdatingItem:i,updateItemFn:h}=le(),[p,g]=j.useState("G"),[r,l]=j.useState({name:s.name,costPrice:s.costPrice,sellingPrice:s.sellingPrice,quantity:s.quantity,inventoryCategory:s.inventoryCategory,importance:s.importance||"C",importedOn:new Date(s.importedOn).toISOString(),expiresOn:s.expiresOn?new Date(s.expiresOn).toISOString():new Date().toISOString(),weight:s.weight,colour:s.colour,reorderLevel:s.reorderLevel,origin:s.origin}),f=()=>{if(r.name.trim()==="")return m.warning("Item should have a name",{className:"toast"});if(r.costPrice<=0)return m.warning("Cost price can't be 0",{className:"toast"});if(r.sellingPrice<=0)return m.warning("Selling price can't be 0",{className:"toast"});if(r.quantity<=0)return m.warning("Quantity can't be 0",{className:"toast"});if(r.inventoryCategory.trim()==="")return m.warning("Category of item is required",{className:"toast"});if(!["A","B","C"].includes(r.importance.trim()))return m.warning("Item importance is invalid",{className:"toast"});if(new Date(r.importedOn)>new Date)return m.warning("Imported data can't be in future",{className:"toast"});if(r.weight&&r.weight<=0)return m.warning("Item can't be weightless",{className:"toast"});const t=JSON.parse(JSON.stringify(r));t.weight=Y(p,r.weight),t.name=t.name.trim(),t.inventoryCategory=t.inventoryCategory.trim(),t.colour=t.colour?.trim(),t.origin=t.origin?.trim(),h({itemId:s._id,newItem:t}),a(!1)};return e.jsx(A,{openModal:n,children:e.jsxs(N,{className:"w-md max-w-11/12",children:[e.jsxs(y,{className:"flex justify-between items-center",children:[e.jsx(M,{children:"Update item"}),e.jsx(o,{onClick:()=>a(!1),variant:"secondary",children:e.jsx(U,{})})]}),e.jsxs(w,{className:"grid gap-2 max-h-96 overflow-auto",children:[e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"name",className:"grid",children:[e.jsx("span",{children:"Name"}),e.jsx(x,{id:"name",name:"name",type:"text",value:r.name,onChange:t=>l({...r,name:t.target.value}),placeholder:"Enter item's name"})]}),e.jsxs(d,{htmlFor:"inventory-category",className:"grid",children:[e.jsx("span",{children:"Inventory Category"}),e.jsx(x,{id:"inventory-category",name:"inventoryCategory",type:"text",value:r.inventoryCategory,onChange:t=>l({...r,inventoryCategory:t.target.value}),placeholder:"Enter item's inventory category"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"costprice",className:"grid",children:[e.jsx("span",{children:"Cost Price"}),e.jsx(x,{id:"costprice",name:"costPrice",type:"number",onFocus:t=>t.target.select(),value:r.costPrice,min:0,onChange:t=>l({...r,costPrice:Number(t.target.value)}),placeholder:"Enter item cost price",required:!0})]}),e.jsxs(d,{htmlFor:"sellingprice",className:"grid",children:[e.jsx("span",{children:"Selling Price"}),e.jsx(x,{id:"sellingprice",name:"sellingPrice",type:"number",onFocus:t=>t.target.select(),value:r.sellingPrice,onChange:t=>l({...r,sellingPrice:Number(t.target.value)}),placeholder:"Enter item selling price",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"quantity",className:"grid",children:[e.jsx("span",{children:"Quantity"}),e.jsx(x,{id:"quantity",name:"quantity",type:"number",onFocus:t=>t.target.select(),value:r.quantity,onChange:t=>l({...r,quantity:Number(t.target.value)}),placeholder:"Enter item quantity",required:!0})]}),e.jsxs("div",{className:"flex gap-2 items-end w-full",children:[e.jsxs(d,{htmlFor:"weight",className:"grid w-full",children:[e.jsx("span",{children:"Weight"}),e.jsx(x,{id:"weight",name:"weight",type:"number",onFocus:t=>t.target.select(),min:1,value:r.weight,onChange:t=>l({...r,weight:Number(t.target.value)}),placeholder:"Enter item's weight"})]}),e.jsxs(H,{children:[e.jsx(_,{asChild:!0,children:e.jsx(o,{variant:"outline",children:p})}),e.jsx(z,{children:e.jsx(W,{defaultValue:p,onValueChange:t=>g(t),children:["KG","G","MG","ML","L","KL"].map((t,v)=>e.jsx($,{value:t,children:t},v))})})]})]})]}),e.jsxs(d,{htmlFor:"importance",className:"grid",children:[e.jsx("span",{children:"Importance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(o,{onClick:()=>l({...r,importance:"A"}),variant:r.importance==="A"?"secondary":"outline",className:"rounded-e-none",children:"A"}),e.jsx(o,{onClick:()=>l({...r,importance:"B"}),variant:r.importance==="B"?"secondary":"outline",className:"rounded-s-none rounded-e-none",children:"B"}),e.jsx(o,{onClick:()=>l({...r,importance:"C"}),variant:r.importance==="C"?"secondary":"outline",className:"rounded-s-none",children:"C"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"importedon",className:"grid",children:[e.jsx("span",{children:"Imported On"}),e.jsx(x,{id:"importedon",name:"importedOn",type:"date",value:new Date(r.importedOn).toISOString().split("T")[0],max:r.expiresOn?new Date(r.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:t=>{l({...r,importedOn:new Date(t.target.valueAsDate||r.importedOn).toISOString()})},placeholder:"Enter item's imported date",className:"w-full",required:!0})]}),e.jsxs(d,{htmlFor:"expireson",className:"grid",children:[e.jsx("span",{children:"Expires On"}),e.jsx(x,{id:"expireson",name:"expiresOn",type:"date",value:r.expiresOn?new Date(r.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],min:new Date(r.importedOn).toISOString().split("T")[0],onChange:t=>{l({...r,expiresOn:t.target.valueAsDate?new Date(t.target.valueAsDate).toISOString():void 0})},placeholder:"Enter item's expiry date",className:"w-full"})]})]}),e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"colour",className:"grid",children:[e.jsx("span",{children:"Colour"}),e.jsx(x,{id:"colour",name:"colour",type:"text",value:r.colour,onChange:t=>l({...r,colour:t.target.value}),placeholder:"Enter item's colour"})]}),e.jsxs(d,{htmlFor:"origin",className:"grid",children:[e.jsx("span",{children:"Origin Place"}),e.jsx(x,{id:"origin",name:"origin",type:"text",value:r.origin,onChange:t=>l({...r,origin:t.target.value}),placeholder:"Enter item's origin place"})]})]}),e.jsx("div",{className:"grid gap-2 grid-cols-2",children:e.jsxs(d,{htmlFor:"reorderlevel",className:"grid",children:[e.jsx("span",{children:"Re-Order Level"}),e.jsx(x,{id:"reorderlevel",name:"reorderLevel",type:"number",onFocus:t=>t.target.select(),min:0,value:r.reorderLevel,onChange:t=>l({...r,reorderLevel:Number(t.target.value)}),placeholder:"Enter item's re-order level"})]})})]}),e.jsxs(C,{className:"flex gap-2",children:[e.jsx(o,{type:"button",onClick:()=>a(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:f,disabled:i,children:"Update Item"})]})]})})}function ce(n){const{data:a,isPending:s}=E({queryKey:["employee-status"],queryFn:()=>te(n)});return{isEmployee:a,isCheckingEmployment:s}}function Ie(){const{SKU:n,orgSlug:a}=G();(!n||!a)&&m.error("Item not found",{className:"toast"});const{item:s,isGettingItem:i}=ae(n||""),{user:h,isCheckingAuth:p}=K(),{isEmployee:g,isCheckingEmployment:r}=ce(a||""),l=h?.user,f=q(),[t,v]=j.useState(!1),[T,b]=j.useState(!1);return i||p||r?e.jsx(Q,{}):e.jsxs("div",{className:"flex flex-col justify-start gap-3 items-center bg-ls-bg-300 dark:bg-ls-bg-dark-800 min-h-dvh relative",children:[e.jsx(X,{hide:{userButton:!0},children:e.jsxs(o,{variant:"outline",onClick:()=>f(-1),children:[e.jsx(k,{})," ",e.jsx("span",{className:"hidden sm:flex",children:"Go Back"})]})}),s?e.jsxs("main",{className:"grid gap-2 p-2 rounded-2xl items-center place-items-center",children:[e.jsx(re,{item:s,viewMorePath:l?"/dashboard":"/authenticate",barebone:!g}),!!g&&e.jsxs("div",{className:"flex w-full gap-1",children:[e.jsx(o,{variant:"secondary",className:"flex-1",onClick:()=>b(!0),children:"Edit Item Data"}),e.jsx(o,{variant:"destructive",className:"flex-1",onClick:()=>v(!0),children:"Delete Data"}),e.jsx(ie,{open:t,setOpen:v,itemData:s}),e.jsx(oe,{open:T,setOpen:b,item:s})]})]}):e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>f(-1),children:[e.jsx(k,{})," Go Back"]}),e.jsx("div",{className:"grid place-items-center gap-2 p-2 min-w-md outline-1 rounded-2xl items-center",children:"Not Item Found"}),e.jsx("div",{className:"w-20"})]})]})}export{Ie as default};
