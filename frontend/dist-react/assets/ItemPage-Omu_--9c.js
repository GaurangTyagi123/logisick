import{r as j,j as e,d as I,L as B,b as E,a as P,y as m,u as q,c as G,g as K,i as Q}from"./index-D2pWsFwA.js";import{C as N,a as y,c as w,d as C,b as M}from"./card-Dn0_vEQo.js";import{b as S,B as o,M as R,u as L,S as O}from"./button-CHgQs-HN.js";import{S as u,D as H,a as _,b as $,j as z,k as W}from"./separator-Qx3zLuA7.js";import{H as J}from"./Profilepage-Br66LqFQ.js";import{d as D,f as F,p as V,u as Y}from"./utilfn-VpFqLrdN.js";import{N as X}from"./Navbar-DRzERZVX.js";import{d as Z,e as ee,u as se,f as te}from"./apiItem-DVgWxXRh.js";import{C as U}from"./Close-DHzJ_a41.js";import{M as A}from"./Modal-C0gzKlS3.js";import{I as x}from"./input-D6dxfwAL.js";import{L as d}from"./label-BT6TXPrt.js";import{P as k}from"./Docspage-C_YMo0mx.js";import"./UserAvatar-CZB3-UBW.js";function c({field:i,fieldName:n,suffix:a,small:r}){return e.jsxs("div",{className:I("flex justify-between items-center",r?"text-xs":"text-sm"),children:[e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[n," :"," "]}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap max-w-4/10",children:[i||e.jsx(R,{children:"NA"}),a]})]})}function re({className:i,item:n,orgSlug:a,small:r,barebone:g=!1,viewMorePath:p}){const[h,s]=j.useState(!1);return e.jsxs("div",{className:I("aspect-square w-2xs sm:w-xs md:w-sm max-w-11/12 outline-none duration-1000 [perspective:10rem] transform-3d",h&&"[transform:rotateY(180deg)]",r?"max-w-xs":"max-w-md",i),children:[e.jsxs(N,{className:"inset-0 p-2 md:p-4 gap-2 absolute [backface-visibility:hidden]",children:[e.jsxs(y,{className:"w-full h-min ",children:[e.jsx(S,{className:"text-center jet-brains",children:n?.SKU?.substring(25)}),n.expiresOn&&D(n.expiresOn)<=15&&e.jsxs("div",{className:I("bg-ls-sec-400 dark:bg-ls-sec-900 rounded-lg w-full flex items-center justify-center gap-1 jet-brains",r?"p-1 text-sm":"p-1 text-md"),children:[e.jsx(J,{})," item exipres in"," ",D(n.expiresOn)," days"]})]}),e.jsxs(w,{className:"w-full h-90 gap-2 grid overflow-y-auto scrollbar p-2 md:p-4 rounded-2xl",children:[e.jsx(c,{small:r,field:n.name,fieldName:"Name"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.inventoryCategory,fieldName:"Category"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.origin,fieldName:"Origin"}),n?.expiresOn&&e.jsxs(e.Fragment,{children:[!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:new Date(n.expiresOn).toLocaleDateString(),fieldName:"Expires On"})]}),!g&&e.jsxs(e.Fragment,{children:[!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:F(n.costPrice),fieldName:"Cost Price",suffix:" /-"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:F(n.sellingPrice),fieldName:"Selling Price",suffix:" /-"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.quantity,fieldName:"Quantity",suffix:" units"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:new Date(n.importedOn).toLocaleDateString(),fieldName:"Imported On"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.colour,fieldName:"Colour"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.weight&&V(n.weight),fieldName:"Weight"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.importance,fieldName:"Importance"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.reorderLevel,fieldName:"Reorder Level"}),!r&&e.jsx(u,{}),e.jsx(c,{small:r,field:n.batchNumber,fieldName:"Batch Number"})]})]}),e.jsxs(C,{className:"grid grid-cols-2 gap-1 p-0 md:p-0",children:[e.jsx(o,{onClick:()=>s(!0),className:"col-span-1 w-full",size:"sm",children:"Show Qrcode"}),e.jsx(B,{to:p||"/authenticate",className:"col-span-1",children:e.jsxs(o,{className:"w-full",size:"sm",children:["More ",e.jsx("span",{className:"hidden sm:flex",children:"About Item"})]})})]})]}),e.jsxs(N,{className:"inset-0 size-full p-2 md:p-4 gap-2 absolute [backface-visibility:hidden] [transform:rotateY(180deg)]",children:[e.jsx(y,{className:"w-full text-center",children:e.jsx(S,{className:"jet-brains",children:"Scan Me"})}),e.jsx(w,{className:"grid place-items-center",children:e.jsx("img",{src:`https://encode.ravishdev.org/api/create/text_url?text_url=https://logisick.onrender.com/item/${a}/${n?.SKU}&fg=%2368a872&bg=%230e2033`,alt:n?.name.substring(0,10),className:"rounded-2xl md:max-w-10/12 max-w-2/3"})}),e.jsx(C,{className:"w-full p-0 md:p-0",children:e.jsx(o,{onClick:()=>s(!1),className:"w-full",children:"Show Information"})})]})]})}function ne(i){const{data:n,isPending:a}=E({queryKey:["item",i],queryFn:()=>Z(i),staleTime:0});return{item:n,isGettingItem:a}}function ae(){const i=P(),{mutate:n,isPending:a}=L({mutationFn:ee,onSuccess:()=>{i.invalidateQueries({predicate:r=>["items","items-report"].includes(r.queryKey[0]?.toString()||"")}),m.success("Item deleted successfully",{className:"toast"})},onError:r=>{m.error(r.message,{className:"toast"})}});return{deleteItemFn:n,isDeletingItem:a}}function ie({open:i,setOpen:n,itemData:a}){const[r,g]=j.useState(""),p=q(),{deleteItemFn:h,isDeletingItem:s}=ae();return e.jsx(A,{openModal:i,children:e.jsxs(N,{className:"w-md max-w-11/12",children:[e.jsxs(y,{className:"flex justify-between items-center",children:[e.jsx(M,{children:"Remove Item"}),e.jsx(o,{onClick:()=>n(!1),variant:"secondary",children:e.jsx(U,{})})]}),e.jsxs(w,{className:"grid gap-4",children:[e.jsxs(O,{children:["Item's Name : ",a.name]}),e.jsxs(O,{children:["Item's SKU : ",a.SKU?.substring(25)]}),e.jsxs(d,{title:"remove item",htmlFor:"removeitem",className:"grid",children:[e.jsxs("span",{children:['Enter "',e.jsxs("span",{className:"text-red-500",children:["remove ",a.name]}),'" in the input below to remove item']}),e.jsx(x,{placeholder:"Enter Text",type:"text",value:r,name:"name",required:!0,className:"text-sm md:text-md",onChange:l=>g(l.target.value)})]})]}),e.jsxs(C,{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>n(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:()=>{h(a._id),n(!1),g(""),p(-1)},disabled:s||r.trim()!==`remove ${a.name}`,variant:"destructive",children:"Remove Item"})]})]})})}function le(){const i=P(),{mutate:n,isPending:a}=L({mutationFn:se,onSuccess:()=>{i.invalidateQueries({predicate:r=>["items","items-report"].includes(r.queryKey[0]?.toString()||"")}),m.success("Item updated successfully",{className:"toast"})},onError:r=>{m.error(r.message,{className:"toast"})}});return{updateItemFn:n,isUpdatingItem:a}}function oe({open:i,setOpen:n,item:a}){const{isUpdatingItem:r,updateItemFn:g}=le(),[p,h]=j.useState("G"),[s,l]=j.useState({name:a.name,costPrice:a.costPrice,sellingPrice:a.sellingPrice,quantity:a.quantity,inventoryCategory:a.inventoryCategory,importance:a.importance||"C",importedOn:new Date(a.importedOn).toISOString(),expiresOn:a.expiresOn?new Date(a.expiresOn).toISOString():new Date().toISOString(),weight:a.weight,colour:a.colour,reorderLevel:a.reorderLevel,origin:a.origin}),f=()=>{if(s.name.trim()==="")return m.warning("Item should have a name",{className:"toast"});if(s.costPrice<=0)return m.warning("Cost price can't be 0",{className:"toast"});if(s.sellingPrice<=0)return m.warning("Selling price can't be 0",{className:"toast"});if(s.quantity<=0)return m.warning("Quantity can't be 0",{className:"toast"});if(s.inventoryCategory.trim()==="")return m.warning("Category of item is required",{className:"toast"});if(!["A","B","C"].includes(s.importance.trim()))return m.warning("Item importance is invalid",{className:"toast"});if(new Date(s.importedOn)>new Date)return m.warning("Imported data can't be in future",{className:"toast"});if(s.weight&&s.weight<=0)return m.warning("Item can't be weightless",{className:"toast"});const t=JSON.parse(JSON.stringify(s));t.weight=Y(p,s.weight),t.name=t.name.trim(),t.inventoryCategory=t.inventoryCategory.trim(),t.colour=t.colour?.trim(),t.origin=t.origin?.trim(),g({itemId:a._id,newItem:t}),n(!1)};return e.jsx(A,{openModal:i,children:e.jsxs(N,{className:"w-md max-w-11/12",children:[e.jsxs(y,{className:"flex justify-between items-center",children:[e.jsx(M,{children:"Update item"}),e.jsx(o,{onClick:()=>n(!1),variant:"secondary",children:e.jsx(U,{})})]}),e.jsxs(w,{className:"grid gap-2 max-h-96 overflow-auto",children:[e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"name",className:"grid",children:[e.jsx("span",{children:"Name"}),e.jsx(x,{id:"name",name:"name",type:"text",value:s.name,onChange:t=>l({...s,name:t.target.value}),placeholder:"Enter item's name"})]}),e.jsxs(d,{htmlFor:"inventory-category",className:"grid",children:[e.jsx("span",{children:"Inventory Category"}),e.jsx(x,{id:"inventory-category",name:"inventoryCategory",type:"text",value:s.inventoryCategory,onChange:t=>l({...s,inventoryCategory:t.target.value}),placeholder:"Enter item's inventory category"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"costprice",className:"grid",children:[e.jsx("span",{children:"Cost Price"}),e.jsx(x,{id:"costprice",name:"costPrice",type:"number",onFocus:t=>t.target.select(),value:s.costPrice,min:0,onChange:t=>l({...s,costPrice:Number(t.target.value)}),placeholder:"Enter item cost price",required:!0})]}),e.jsxs(d,{htmlFor:"sellingprice",className:"grid",children:[e.jsx("span",{children:"Selling Price"}),e.jsx(x,{id:"sellingprice",name:"sellingPrice",type:"number",onFocus:t=>t.target.select(),value:s.sellingPrice,onChange:t=>l({...s,sellingPrice:Number(t.target.value)}),placeholder:"Enter item selling price",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"quantity",className:"grid",children:[e.jsx("span",{children:"Quantity"}),e.jsx(x,{id:"quantity",name:"quantity",type:"number",onFocus:t=>t.target.select(),value:s.quantity,onChange:t=>l({...s,quantity:Number(t.target.value)}),placeholder:"Enter item quantity",required:!0})]}),e.jsxs("div",{className:"flex gap-2 items-end w-full",children:[e.jsxs(d,{htmlFor:"weight",className:"grid w-full",children:[e.jsx("span",{children:"Weight"}),e.jsx(x,{id:"weight",name:"weight",type:"number",onFocus:t=>t.target.select(),min:1,value:s.weight,onChange:t=>l({...s,weight:Number(t.target.value)}),placeholder:"Enter item's weight"})]}),e.jsxs(H,{children:[e.jsx(_,{asChild:!0,children:e.jsx(o,{variant:"outline",children:p})}),e.jsx($,{children:e.jsx(z,{defaultValue:p,onValueChange:t=>h(t),children:["KG","G","MG","ML","L","KL"].map((t,v)=>e.jsx(W,{value:t,children:t},v))})})]})]})]}),e.jsxs(d,{htmlFor:"importance",className:"grid",children:[e.jsx("span",{children:"Importance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(o,{onClick:()=>l({...s,importance:"A"}),variant:s.importance==="A"?"secondary":"outline",className:"rounded-e-none",children:"A"}),e.jsx(o,{onClick:()=>l({...s,importance:"B"}),variant:s.importance==="B"?"secondary":"outline",className:"rounded-s-none rounded-e-none",children:"B"}),e.jsx(o,{onClick:()=>l({...s,importance:"C"}),variant:s.importance==="C"?"secondary":"outline",className:"rounded-s-none",children:"C"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{htmlFor:"importedon",className:"grid",children:[e.jsx("span",{children:"Imported On"}),e.jsx(x,{id:"importedon",name:"importedOn",type:"date",value:new Date(s.importedOn).toISOString().split("T")[0],max:s.expiresOn?new Date(s.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:t=>{l({...s,importedOn:new Date(t.target.valueAsDate||s.importedOn).toISOString()})},placeholder:"Enter item's imported date",className:"w-full",required:!0})]}),e.jsxs(d,{htmlFor:"expireson",className:"grid",children:[e.jsx("span",{children:"Expires On"}),e.jsx(x,{id:"expireson",name:"expiresOn",type:"date",value:s.expiresOn?new Date(s.expiresOn).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],min:new Date(s.importedOn).toISOString().split("T")[0],onChange:t=>{l({...s,expiresOn:t.target.valueAsDate?new Date(t.target.valueAsDate).toISOString():void 0})},placeholder:"Enter item's expiry date",className:"w-full"})]})]}),e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsxs(d,{htmlFor:"colour",className:"grid",children:[e.jsx("span",{children:"Colour"}),e.jsx(x,{id:"colour",name:"colour",type:"text",value:s.colour,onChange:t=>l({...s,colour:t.target.value}),placeholder:"Enter item's colour"})]}),e.jsxs(d,{htmlFor:"origin",className:"grid",children:[e.jsx("span",{children:"Origin Place"}),e.jsx(x,{id:"origin",name:"origin",type:"text",value:s.origin,onChange:t=>l({...s,origin:t.target.value}),placeholder:"Enter item's origin place"})]})]}),e.jsx("div",{className:"grid gap-2 grid-cols-2",children:e.jsxs(d,{htmlFor:"reorderlevel",className:"grid",children:[e.jsx("span",{children:"Re-Order Level"}),e.jsx(x,{id:"reorderlevel",name:"reorderLevel",type:"number",onFocus:t=>t.target.select(),min:0,value:s.reorderLevel,onChange:t=>l({...s,reorderLevel:Number(t.target.value)}),placeholder:"Enter item's re-order level"})]})})]}),e.jsxs(C,{className:"flex gap-2",children:[e.jsx(o,{type:"button",onClick:()=>n(!1),variant:"secondary",children:"Cancel"}),e.jsx(o,{type:"button",onClick:f,disabled:r,children:"Update Item"})]})]})})}function ce(i){const{data:n,isPending:a}=E({queryKey:["employee-status"],queryFn:()=>te(i)});return{isEmployee:n,isCheckingEmployment:a}}function Ie(){const{SKU:i,orgSlug:n}=G();(!i||!n)&&m.error("Item not found",{className:"toast"});const{item:a,isGettingItem:r}=ne(i||""),{user:g,isCheckingAuth:p}=K(),{isEmployee:h,isCheckingEmployment:s}=ce(n||""),l=g?.user,f=q(),[t,v]=j.useState(!1),[T,b]=j.useState(!1);return r||p||s?e.jsx(Q,{}):e.jsxs("div",{className:"flex flex-col justify-start gap-3 items-center bg-ls-bg-300 dark:bg-ls-bg-dark-800 min-h-dvh relative",children:[e.jsx(X,{hide:{userButton:!0},children:e.jsxs(o,{variant:"outline",onClick:()=>f(-1),children:[e.jsx(k,{})," ",e.jsx("span",{className:"hidden sm:flex",children:"Go Back"})]})}),a?e.jsxs("main",{className:"grid gap-2 p-2 rounded-2xl items-center place-items-center",children:[e.jsx(re,{item:a,orgSlug:n||"",viewMorePath:l?"/dashboard":"/authenticate",barebone:!h}),!!h&&e.jsxs("div",{className:"flex w-full gap-1",children:[e.jsx(o,{variant:"secondary",className:"flex-1",onClick:()=>b(!0),children:"Edit Item Data"}),e.jsx(o,{variant:"destructive",className:"flex-1",onClick:()=>v(!0),children:"Delete Data"}),e.jsx(ie,{open:t,setOpen:v,itemData:a}),e.jsx(oe,{open:T,setOpen:b,item:a})]})]}):e.jsxs("div",{className:"w-full flex flex-wrap justify-between px-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>f(-1),children:[e.jsx(k,{})," Go Back"]}),e.jsx("div",{className:"grid place-items-center gap-2 p-2 min-w-md outline-1 rounded-2xl items-center",children:"Not Item Found"}),e.jsx("div",{className:"w-20"})]})]})}export{Ie as default};
