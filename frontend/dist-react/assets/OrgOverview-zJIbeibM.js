import{r as t,j as e,y as P,a as C,b as I,L as O}from"./index-D0_Sot9h.js";import{u as A}from"./useGetEmployees-c4jXWdlt.js";import{u as M,B}from"./button-BTAYK3jx.js";import{s as T,g as _}from"./apiOrg-BN6cYbtf.js";import{U as z}from"./UserAvatar-D2ytVRyN.js";import{l as Z,C as k,a as F}from"./CustomTableSkeleton-CJzREqlH.js";import{B as y}from"./badge-CtOZmh4p.js";import{a as N,S as E,M as L}from"./Typography-BkeLtctd.js";import{f as S}from"./utilfn-DLliPqnw.js";import{S as m}from"./skeleton-BV3MVaVg.js";import{u as U}from"./useGetItemsReport-hq99Ym3s.js";import{u as q}from"./useGetOrderReport-D3z5Ph02.js";import"./card-uaHBxQ7j.js";import"./input-CUKpUeOa.js";import"./separator-Cmc26UhN.js";import"./table-DXp72nU_.js";import"./Pagination-YlnTxVma.js";import"./apiItem-BA08D8KX.js";import"./apiOrder-_6Dinb-b.js";function v(a){return a?.map(s=>({role:s?.data?.role,...s?.data?.employees}))||[]}function D({orgid:a}){const[i,d]=t.useState(1),[c,u]=t.useState(1),{data:p,count:f,isGettingEmployees:x,error:h}=A(a,c),[g,j]=t.useState(null),{mutate:b}=M({mutationFn:T,onSettled:r=>{if(r)j(v(r.employees.map(l=>({data:l}))));else return}}),n=t.useRef(null),w=t.useCallback(async r=>{n.current&&n.current.abort();const l=new AbortController;n.current=l,r.length&&b({orgid:a,query:r.trim(),controller:l})},[a,b]),o=t.useMemo(()=>Z.debounce(w,500),[w]),R=t.useCallback(r=>{if(r.trim()===""){o.cancel(),j(null),n.current&&n.current.abort();return}o(r)},[o]);if(t.useEffect(()=>{x||d(f>5?Math.ceil(f/5):1)},[f,x]),t.useEffect(()=>()=>{o.cancel(),n.current?.abort()},[o]),x)return e.jsx(k,{});if(h){P.error(h.message,{className:"toast"});return}const G=v(p);return e.jsx(F,{title:"Employees",columns:[{key:"name",header:"Name",render:(r,l)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(z,{className:"w-10 h-10",customSeed:l.avatar}),e.jsx("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:l?.name})]})},{key:"email",header:"Email"},{key:"role",header:"Role"}],clientSide:!0,data:g||G,currentPage:c,totalPages:i,setPage:u,onSearch:R})}function me(){const{orgSlug:a}=C(),{data:s,isPending:i}=I({queryKey:[`org-${a}`],queryFn:()=>_(a)}),{isGettingItemReport:d,report:c}=U(s?._id),{isGettingOrdersReport:u,report:p}=q(s?._id);return i||d||u?e.jsxs("div",{className:"flex flex-col gap-2  items-baseline h-full w-autorounded-2xl bg-ls-bg-300 dark:bg-ls-bg-dark-800",children:[e.jsxs("div",{className:"bg-white dark:bg-ls-bg-dark-800 outline-1 w-full p-3 rounded-2xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center w-full",children:[e.jsx(m,{className:"w-1/3 h-10"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{className:"h-18 w-18"}),e.jsx(m,{className:"h-18 w-18"})]})]}),e.jsx(m,{className:"w-1/2 h-5"})]}),e.jsx(k,{})]}):s?e.jsxs("div",{className:"grid gap-2 jet-brains rounded-2xl bg-ls-bg-300 dark:bg-ls-bg-dark-800",children:[e.jsxs("div",{className:"bg-white dark:bg-ls-bg-dark-800 outline-1 w-full p-3 rounded-lg md:rounded-2xl",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center w-full",children:[e.jsx(N,{className:"overflow-hidden text-ellipsis whitespace-nowrap w-full text-center md:text-start",children:s.name}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(E,{className:"grid place-items-center gap-2 h-full p-2 text-center",children:["Inventory Value",e.jsx(y,{className:"p-2",children:S(c?.totalSellingPrice||0,"INR")})]}),e.jsxs(E,{className:"grid place-items-center gap-2 h-full p-2 text-center",children:["Order Revenue",e.jsx(y,{className:"p-2",children:S(p?.totalRevenue||0,"INR")})]})]})]}),e.jsx(L,{className:"line-clamp-2 md:text-start text-center",children:s.description})]}),s?e.jsx(D,{orgid:s?._id}):e.jsxs("div",{className:"h-96 w-full flex flex-col justify-center items-center gap-3 outline-1",children:[e.jsx(N,{children:"Your Organization doesn't have any employees"}),e.jsx(B,{asChild:!0,children:e.jsx(O,{to:"user-role",children:"Add Employees"})})]})]}):e.jsx("p",{children:"Create your own organiztion"})}export{me as default};
