const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateOrderModal-E5h1td7j.js","assets/index-m80HHom9.js","assets/index-bkEeQSt0.css","assets/Close-DPtO1cWq.js","assets/Modal-DoJZ0Xvx.js","assets/button-ClPKnN6O.js","assets/Typography-NNxUExT6.js","assets/card-BQdcvxv4.js","assets/input-BO2ORJHh.js","assets/label-cYvjZa07.js","assets/separator-CUHlGSBl.js","assets/apiOrg-j2pr1aRv.js","assets/AddItemModal-C-AjA-oE.js","assets/apiItem-FWD_FFlK.js","assets/CustomTableSkeleton-DZWWBmKY.js","assets/table-Bo_BBBsG.js","assets/Pagination-DL0um6Cl.js","assets/skeleton-YSt8wfMh.js","assets/utilfn-DLliPqnw.js"])))=>i.map(i=>d[i]);
import{c as _,b as N,y as O,a as D,r as s,j as e,L as T,_ as A}from"./index-m80HHom9.js";import{g as P,s as K}from"./apiItem-FWD_FFlK.js";import{g as E}from"./apiOrg-j2pr1aRv.js";import{u as R,B as j}from"./button-ClPKnN6O.js";import{l as z,C as M,a as B}from"./CustomTableSkeleton-DZWWBmKY.js";import{M as y,a as $,L as k}from"./Typography-NNxUExT6.js";import{E as U}from"./Profilepage-CIQa6KaG.js";import{p as V}from"./utilfn-DLliPqnw.js";import{c as W}from"./apiOrder-BX_Bsx8a.js";import{R as d}from"./ReportBar-VrHBA91x.js";import{S as u}from"./skeleton-YSt8wfMh.js";import{u as Z}from"./useGetItemsReport-C8cm_gke.js";import"./card-BQdcvxv4.js";import"./input-BO2ORJHh.js";import"./separator-CUHlGSBl.js";import"./table-Bo_BBBsG.js";import"./Pagination-DL0um6Cl.js";import"./badge-BiW4ej1H.js";const H=5;function J(i,t){const l=_(),{data:a,isPending:c}=N({queryKey:["items",t],queryFn:()=>P(i,t)});return a&&H*t+1<a.count&&l.prefetchQuery({queryKey:["items",t+1],queryFn:()=>P(i,t+1)}),{itemsResponse:a,isGettingItems:c}}function X(){const i=_(),{mutate:t,isPending:l}=R({mutationFn:W,onSuccess:()=>{i.invalidateQueries({predicate:a=>["orders","orders-report"].includes(a.queryKey[0]?.toString()||"")}),O.success("Order created successfully",{className:"toast"})},onError:a=>{O.error(a.message||"Error creating Order",{className:"toast"})}});return{createOrderFn:t,isCreatingOrder:l}}const Y=s.lazy(()=>A(()=>import("./CreateOrderModal-E5h1td7j.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));function ee(){const{orgSlug:i}=D(),t=5,[l,a]=s.useState(1),[c,n]=s.useState(1),[f,F]=s.useState({itemName:"",itemId:"",itemAmount:0}),[L,b]=s.useState(!1),{createOrderFn:q,isCreatingOrder:w}=X(),{data:x,isPending:G}=N({queryKey:[`org-${i}`],queryFn:()=>E(i)}),{itemsResponse:m,isGettingItems:h}=J(x._id,l),[S,v]=s.useState(null),{mutate:C}=R({mutationFn:K,onSettled:r=>{if(r)v(r.items);else return}}),g=s.useRef(null),I=s.useCallback(async r=>{g.current&&g.current.abort();const o=new AbortController;if(g.current=o,r.trim().length)return C({orgid:x._id,query:r,controller:o})},[x._id,C]),p=s.useMemo(()=>z.debounce(I,500),[I]),Q=s.useCallback(r=>{if(r.trim()===""){p.cancel(),v(null),g.current&&g.current.abort();return}p(r)},[p]);return s.useEffect(()=>{!h&&m&&n(m.count>t?Math.ceil(m.count/t):1)},[m,h,c]),h||G?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Items",columns:[{key:"name",header:"Name",render:r=>e.jsx("span",{className:"font-bold",children:r instanceof Date?new Date(r).toLocaleDateString():r})},{key:"importedOn",header:"Imported On",render:r=>r?new Date(r).toLocaleDateString():e.jsx(y,{children:"NA"})},{key:"expiresOn",header:"Expires On",render:r=>r?new Date(r).toLocaleDateString():e.jsx(y,{children:"NA"})},{key:"inventoryCategory",header:"Category"},{key:"batchNumber",header:"Batch No.",render:r=>r?r instanceof Date?new Date(r).toLocaleDateString():r:e.jsx(y,{children:"NA"})},{key:"weight",header:"Unit Weight",render:r=>V(Number(r))},{key:"quantity",header:"Quantity"},{key:"costPrice",header:"Cost Price",render:r=>e.jsxs("span",{className:"w-full font-bold text-red-400",children:[r instanceof Date?new Date(r).toLocaleDateString():r," ","/-"]})},{key:"sellingPrice",header:"Selling Price",render:r=>e.jsxs("span",{className:"w-full font-bold text-green-400",children:[r instanceof Date?new Date(r).toLocaleDateString():r," ","/-"]})},{key:"createorder",header:"Create Order",render:(r,o)=>e.jsx(j,{disabled:w,onClick:()=>{F({itemId:o._id,itemName:o.name,itemAmount:o.quantity}),b(!0)},variant:"outline",size:"sm",className:"text-xs sm:text-sm",children:"Create Order"})},{key:"Manage",header:"Manage",render:(r,o)=>e.jsx(T,{to:`/item/${x.slug}/${o.SKU}`,children:e.jsx(j,{variant:"outline",size:"sm","aria-label":"Edit Item",children:e.jsx(U,{})})})}],clientSide:!0,data:S||m?.items||[],currentPage:l,totalPages:c,setPage:a,onSearch:Q}),e.jsx(Y,{open:L,setOpen:b,orderdata:f,createOrderFn:q,isCreatingOrder:w})]})}const re=s.lazy(()=>A(()=>import("./AddItemModal-C-AjA-oE.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,10,8,9,13,11,14,15,16,17,18])));function Ne(){const[i,t]=s.useState(!1),{orgSlug:l}=D(),{data:a,isPending:c}=N({queryKey:[`org-${l}`],queryFn:()=>E(l)}),{report:n,isGettingItemReport:f}=Z(a?._id);return c||f?e.jsxs("div",{className:"flex flex-col gap-2  items-baseline h-full w-autorounded-2xl bg-ls-bg-300 dark:bg-ls-bg-dark-800",children:[e.jsxs("div",{className:"bg-white dark:bg-ls-bg-dark-800 outline-1 w-full p-3 rounded-2xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center w-full",children:[e.jsx(u,{className:"w-1/3 h-10"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{className:"h-18 w-18"}),e.jsx(u,{className:"h-18 w-18"})]})]}),e.jsx(u,{className:"w-1/2 h-5"})]}),e.jsx("div",{className:"outline-1 p-4  w-full rounded-2xl",children:e.jsx(u,{className:"w-full h-30"})}),e.jsx(M,{})]}):e.jsxs("div",{className:"grid gap-2 w-full",children:[e.jsxs("div",{className:"grid w-full md:flex md:items-center md:justify-between gap-2 p-1 md:p-3 rounded-lg md:rounded-2xl bg-white dark:bg-ls-bg-dark-800 outline-1",children:[e.jsx($,{children:"Product Management"}),e.jsx(j,{onClick:()=>t(!0),children:"Add New Item"})]}),e.jsxs("main",{className:"w-full grid gap-2 rounded-lg md:rounded-2xl h-full",children:[e.jsxs("div",{className:"outline-1 p-3 rounded-lg md:rounded-2xl flex flex-col gap-2 w-full bg-white dark:bg-ls-bg-dark-800",children:[e.jsx(k,{children:"Items Summary"}),n?e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 w-full gap-2",children:[e.jsx(d,{name:"No. of Items",value:n.numOfItems,variant:"outline"}),e.jsx(d,{name:"Total Quantity",value:n.totalQuantity,variant:"outline"}),e.jsx(d,{name:"Avg. Quantity per Item",value:n.averageQuantity,variant:"outline"})]}),e.jsxs("div",{className:"grid gap-2 w-full grid-cols-1 2xl:grid-cols-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-2",children:[e.jsx(d,{name:"Total Cost Price",value:n.totalCostPrice,suffix:"INR",currency:!0,variant:"secondary"}),e.jsx(d,{name:"Total Selling Price",value:n.totalSellingPrice,suffix:"INR",currency:!0,variant:"secondary"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 w-full gap-2",children:[e.jsx(d,{name:"Avg. Cost Price",value:n.averageCostPrice,suffix:"INR",currency:!0,variant:"secondary"}),e.jsx(d,{name:"Avg. Selling Price",value:n.averageSellingPrice,suffix:"INR",currency:!0,variant:"secondary"})]})]})]}):f?e.jsx("div",{className:"w-full",children:e.jsx(u,{className:"w-full h-30"})}):e.jsx(k,{className:"w-full",children:"No Report Found"})]}),e.jsx(ee,{})]}),e.jsx(re,{open:i,setOpen:t})]})}export{Ne as default};
